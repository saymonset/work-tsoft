<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core" xml:lang="en" lang="en" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:indeval="http://indeval.com/indeval"
    xmlns:t="http://myfaces.apache.org/tomahawk"
    xmlns:dt="http://blitzsoftware.com/jsf/datetag" 
    xmlns:rich="http://richfaces.org/rich">


    <ui:composition template="/layoutCaptura.xhtml">
        <ui:define name="head">
        <script language="javascript" type="text/javascript"
				src="#{facesContext.externalContext.requestContextPath}/js/consultaPosiciones.js"></script>
            <script language="javascript" type="text/javascript"
                src="#{facesContext.externalContext.requestContextPath}/js/mostrarPosiciones.js"></script>
            <script language="javascript" type="text/javascript"
                src="#{facesContext.externalContext.requestContextPath}/js/mostrarFirmaDigital.js"></script>
        </ui:define>
        <ui:define name="tituloEncabezado">
            <h:outputText value="#{etq.miscelaneaFiscal}" />

        </ui:define>


        <ui:define name="seccionForma">
        	<h:outputText  value="#{traspasoMiscelaneaFiscalCapitalesBean.initForm}"></h:outputText>

            <h:outputText id="init" value="#{traspasoMiscelaneaFiscalCapitalesBean.init}"></h:outputText>
            <a4j:keepAlive beanName="traspasoMiscelaneaFiscalCapitalesBean" />
            <h:panelGroup id="general">
                <table width="100%" cellpadding="0px" cellspacing="0px" align="center">
                    <tr align="center">
                        <td align="center" colspan="2">
                            <select id="comboPantalla"
                                onchange="javascript:window.location='#{facesContext.externalContext.requestContextPath}/mercadoCapitales/operacion/'+ this.options[this.selectedIndex].value+'.faces';">
                                <option value="traspasoMiscelaneaFiscalCapitales"  selected="selected">
                                    <h:outputText value="#{etq.miscelaneaFiscal}" />
                                </option>
                                <option value="venta">
                                    <h:outputText value="#{etq.contrapago}" />
                                </option>
                                 <option value="traspasoLibrePago">
                                    <h:outputText value="#{etq.traspasoLibrePago}" />
                                </option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" align="center">
                            <h:panelGrid columns="2">
                                <h:outputText value="#{etq.recepcionMinus}" styleClass="texto" />
                                <h:selectBooleanCheckbox id="recepcion"
                                    value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.recepcion}" tabindex="10">
                                    <a4j:support event="onclick"
                                        reRender="seleccionCuentaTraspasante,seleccionCuentaReceptor, datosPosicionTraspasante, seleccionCuentaReceptor, panelMensajes"
                                        actionListener="#{traspasoMiscelaneaFiscalCapitalesBean.cambioRecepcion}">
                                    </a4j:support>
                                </h:selectBooleanCheckbox>
                            </h:panelGrid>

                        </td>
                    </tr>
                    <tr>
                        <td width="50%">
                        <h:panelGrid id="datosArriba">
                            <h:panelGrid columns="4" width="100%" id="seleccionCuentaTraspasante">
                                <f:facet name="header">
                                    <h:outputText value="#{etq.traspasanteMinus}" styleClass="texto" />
                                </f:facet>
                                <h:outputText value="#{etq.participanteMinus}" styleClass="texto" />
                                <h:outputText value="#{etq.cuentaMinus}" styleClass="texto" />
                                <!-- h:outputText value="#{etq.tenencia}" styleClass="texto" /-->
                                <h:outputText value="#{etq.nombreCuenta}" styleClass="texto" />

                                <h:panelGroup id="folioTraspasante">
                                    <h:inputText autocomplete="off" id="idFolioTraspasante" size="5" maxlength="5"
                                        value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.idFolioTraspasante}"
                                        styleClass="#{!traspasoMiscelaneaFiscalCapitalesBean.editarTraspasante ? 'readonly' : 'campoNumericoAsterisco'}" tabindex="20">
                                        <a4j:support event="onchange" reRender="init, nombreInstitucionTraspasante" oncomplete="establecerFoco('cuentaTraspasante');"/>
                                    </h:inputText>    
                                        
                                    <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="idFolioTraspasante"
                                    ignoreDupResponses="true"
								eventsQueue="folioQueue"
								requestDelay ="#{inicioSesionBean.delay}"
                                        suggestionAction="#{seleccionarCuentaBean.buscarParticipante}" var="coincidencia"
                                        fetchValue="#{coincidencia.claveTipoInstitucion}#{coincidencia.folioInstitucion}"
                                        minChars="1" width="200" immediate="false" nothingLabel="Sin coincidencias">
                                        <h:column>
                                            <h:outputText
                                                value="#{coincidencia.claveTipoInstitucion}#{coincidencia.folioInstitucion}"
                                                styleClass="texto" /> - <h:outputText value="#{coincidencia.nombreCorto}"
                                                styleClass="texto" />
                                        </h:column>
                                        <a4j:support event="onselect" reRender="init,nombreInstitucionTraspasante" />
                                    </rich:suggestionbox>
                                </h:panelGroup>
                                <h:panelGroup id="ctaTraspasante">
                                	<h:panelGroup id="panelCuentaTraspasante">
	                                    <h:inputText autocomplete="off" id="cuentaTraspasante" size="4" maxlength="4"
	                                        value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.posicionTraspasante.cuenta.cuenta}"
	                                        tabindex="30" styleClass="campoNumericoAsterisco" >
	                                        <a4j:support event="onchange" reRender="init,tenenciaTraspasante,panelSerie,panelEmisora,cupon,boveda,isin,diasVigentes,saldoDisponible,  nombreInstitucionTraspasante"
	                                        			oncomplete="establecerFoco('tipoValor');"/>
	                                   	</h:inputText>
	                                    <input type="hidden" id="nombre_id_folio_traspasante" name="nombre_id_folio_traspasante"
	                                        value="daliForm:idFolioTraspasante" />
	                                    <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="cuentaTraspasante"
	                                    	ignoreDupResponses="true"
											eventsQueue="folioTraspasanteQueue"
											requestDelay ="#{inicioSesionBean.delay}"
	                                        suggestionAction="#{seleccionarCuentaBean.buscarCuentaTraspasante}" var="coincidencia"
	                                        fetchValue="#{coincidencia.cuenta}" minChars="1" width="80"
	                                        nothingLabel="Sin coincidencias">
	                                        <h:column>
	                                            <h:outputText value="#{coincidencia.cuenta}" styleClass="texto" />
	                                        </h:column>
	                                        <a4j:support event="onselect" actionListener="#{traspasoMiscelaneaFiscalCapitalesBean.validarCuenta}" reRender="init,tenenciaTraspasante,nombreInstitucionTraspasante" />
	                                    </rich:suggestionbox>
	                             	</h:panelGroup>
                                </h:panelGroup>
								
                                <!-- h:inputText id="tenenciaTraspasante" size="8"
                                   	value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.posicionTraspasante.cuenta.tipoTenencia.claveTipoCuenta}"
                                   	styleClass="readonly" /-->
                                <h:inputText autocomplete="off" id="nombreInstitucionTraspasante" size="40"
                                   	value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.posicionTraspasante.cuenta.nombreCuenta}"
                                   	styleClass="readonly" />
                            </h:panelGrid>
                            </h:panelGrid>
                        </td>
                        <td width="50%">
                            <h:panelGrid columns="4" width="100%" id="seleccionCuentaReceptor">
                                <f:facet name="header">
                                    <h:outputText value="#{etq.receptorMinus}" styleClass="texto" />
                                </f:facet>
                                <h:outputText value="#{etq.participanteMinus}" styleClass="texto" />
                                <h:outputText value="#{etq.cuentaMinus}" styleClass="texto" />
                                <!-- h:outputText value="#{etq.tenencia}" styleClass="texto" /-->
                                <h:outputText value="#{etq.nombreCuenta}" styleClass="texto" />

                                <h:panelGroup id="folioReceptor">
                                    <h:inputText autocomplete="off" id="idFolioReceptor" size="5" maxlength="5"
                                        value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.idFolioReceptor}"
                                        styleClass="#{traspasoMiscelaneaFiscalCapitalesBean.editarReceptor ? 'campoNumericoAsterisco' : 'readonly'}" tabindex="80">
                                        <a4j:support event="onchange" reRender="init, nombreInstitucionReceptor" oncomplete="establecerFoco('cuentaReceptor');"/>
                                    </h:inputText>
                                        
                                    <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="idFolioReceptor" id="suggest_institucionReceptora"
                                        ignoreDupResponses="true"
										eventsQueue="folioReceptorQueue"
										requestDelay ="#{inicioSesionBean.delay}"
                                        suggestionAction="#{seleccionarCuentaBean.buscarParticipante}" var="coincidencia_i"
                                        fetchValue="#{coincidencia_i.claveTipoInstitucion}#{coincidencia_i.folioInstitucion}"
                                        minChars="1" width="200" nothingLabel="Sin coincidencias">
                                        <h:column>
                                            <h:outputText
                                                value="#{coincidencia_i.claveTipoInstitucion}#{coincidencia_i.folioInstitucion}"
                                                styleClass="texto" /> - <h:outputText value="#{coincidencia_i.nombreCorto}"
                                                styleClass="texto" />
                                        </h:column>
                                        <a4j:support event="onselect" reRender="init,nombreInstitucionReceptor" />
                                    </rich:suggestionbox>
                                </h:panelGroup>
                                <h:panelGroup id="ctaReceptor">
                                    <h:inputText autocomplete="off" id="cuentaReceptor" size="4" maxlength="4"
                                        value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.cuentaReceptor.cuenta}"
                                        tabindex="90" styleClass="campoNumericoAsterisco">
                                        <a4j:support event="onchange" reRender="init,tenenciaReceptor,nombreInstitucionReceptor, nombreInstitucionReceptor" oncomplete="establecerFoco('cantidad');"/>
                                    </h:inputText>
                                    <input type="hidden" id="nombre_id_folio_receptor" name="nombre_id_folio_receptor"
                                        value="daliForm:idFolioReceptor" />
                                    <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="cuentaReceptor"
                                    	ignoreDupResponses="true"
										eventsQueue="folioCuentaReceptorQueue"
										requestDelay ="#{inicioSesionBean.delay}"
                                        suggestionAction="#{seleccionarCuentaBean.buscarCuentaReceptor}" var="coincidencia"
                                        fetchValue="#{coincidencia.cuenta}" minChars="1" width="80" immediate="false"
                                        nothingLabel="Sin coincidencias">
                                        <h:column>
                                            <h:outputText value="#{coincidencia.cuenta}" styleClass="texto" />
                                        </h:column>
                                        <a4j:support event="onselect" actionListener="#{traspasoMiscelaneaFiscalCapitalesBean.validarCuenta}" reRender="init,tenenciaReceptor,nombreInstitucionReceptor" />
                                    </rich:suggestionbox>
                                </h:panelGroup>

                                <!-- h:inputText id="tenenciaReceptor" size="15" styleClass="readonly"
                                    value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.cuentaReceptor.tipoTenencia.claveTipoCuenta}" /-->
                                <h:inputText autocomplete="off" id="nombreInstitucionReceptor" size="33" styleClass="readonly"
                                    value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.cuentaReceptor.nombreCuenta}" />
                            </h:panelGrid>
                        </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: top;">
                            <h:panelGroup id="datosPosicionTraspasante" style="position:relative;">
                                <table width="100%" cellpadding="0px" cellspacing="5px">
                                    <tr>
                                        <td width="25%">
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.tv}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>
                                        </td>
                                        <td width="75%">
                                            <h:panelGroup id="panelTipoValor">
                                                <h:inputText autocomplete="off" id="tipoValor" size="7" maxlength="4"
                                                    value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.posicionTraspasante.emision.tipoValor.claveTipoValor}"
                                                    tabindex="40" 
                                                    styleClass="campoAlphaNumericoAsterisco textoTipoValor">
                                                    <a4j:support event="onchange" 
	                                                    reRender="init,panelCuentaTraspasante,panelSerie,cupon,boveda,isin,diasVigentes,saldoDisponible" 
	                                                    oncomplete="establecerFoco('emisora');"/>
                                                </h:inputText>
                                                <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="tipoValor"
	                                                ignoreDupResponses="true"
	                                                eventsQueue="folioTipoValorQueue"
	                                                requestDelay ="#{inicioSesionBean.delay}"
	                                                suggestionAction="#{seleccionarEmisionCapitalesBean.buscarTiposValorPorPrefijo}"
	                                                var="coincidencia" fetchValue="#{coincidencia.claveTipoValor}" minChars="1"
                                                    width="300" immediate="false" nothingLabel="Sin coincidencias">
                                                    <h:column>
                                                        <h:outputText value="#{coincidencia.claveTipoValor}" styleClass="texto" /> - <h:outputText
                                                            value="#{coincidencia.descripcion}" styleClass="texto" />
                                                    </h:column>
                                                </rich:suggestionbox>
                                            </h:panelGroup>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.emisoraMinus}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                            <h:panelGroup id="panelEmisora">
                                                <h:inputText autocomplete="off" id="emisora" size="7" maxlength="7"
                                                    value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.posicionTraspasante.emision.emisora.descripcion}"
                                                    readonly="false" required="false" tabindex="50" styleClass="campoAlphaNumericoEmisora" >
                                                    <a4j:support event="onchange" 
                                                        reRender="init,panelTipoValor,panelCuentaTraspasante,cupon,boveda,isin,diasVigentes,saldoDisponible" 
                                                        oncomplete="establecerFoco('serie');"/>
                                                </h:inputText>
                                                <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="emisora"
                                              		ignoreDupResponses="true"
													eventsQueue="emisoraQueue"
													requestDelay ="#{inicioSesionBean.delay}"
                                                    suggestionAction="#{seleccionarEmisionCapitalesBean.buscarEmisorasPorPrefijo}"
                                                    var="coincidencia" fetchValue="#{coincidencia.descripcion}" minChars="1"
                                                    width="300" immediate="false" nothingLabel="Sin coincidencias">
                                                    <h:column>
                                                        <h:outputText value="#{coincidencia.descripcion}" styleClass="texto" />
                                                    </h:column>
                                                </rich:suggestionbox>
                                            </h:panelGroup>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.serieMinus}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                        	<h:panelGroup id="panelSerie">
	                                            <h:inputText autocomplete="off" id="serie" size="7" maxlength="6"
	                                                value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.posicionTraspasante.emision.serie.serie}"
	                                                tabindex="60"  styleClass="campoAlphaNumericoSerie">
	                                                <a4j:support event="onchange" 
	                                                    reRender="init,panelTipoValor,panelCuentaTraspasante,panelEmisora,cupon,boveda,isin,diasVigentes,saldoDisponible" 
	                                                    oncomplete="establecerFoco('cupon');"/>
	                                           	</h:inputText>
                                           	</h:panelGroup>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.cuponMinus}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                            <h:panelGrid columns="2" width="100%" cellpadding="0px" cellspacing="0px">
                                                <h:inputText autocomplete="off" id="cupon" size="7" maxlength="4"
                                                    value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.posicionTraspasante.emision.cupon}"
                                                    tabindex="70" styleClass="campoNumerico textoCupon"/>
                                                <h:panelGroup>
                                                    <a id="buscarPosicionLink" href="javascript: mostrarPosiciones('Capital');"> <h:graphicImage
                                                            value="/images/search.png">
                                                        </h:graphicImage> <h:outputText value="#{etq.buscarPosicionMinus}" styleClass="texto" /> </a>
												&#160;&#160;&#160;
                                                <a id="limpiarPosicionLink" href="javascript:limpiarDatosPosicion('');"> <h:graphicImage
                                                            value="/images/page_refresh.png">
                                                        </h:graphicImage> <h:outputText value="#{etq.limpiarPosicionMinus}" styleClass="texto" />
                                                    </a>
                                                </h:panelGroup>
                                            </h:panelGrid>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.isin}" styleClass="texto" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                            <h:inputText autocomplete="off" id="isin" size="30" maxlength="12"
                                                value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.posicionTraspasante.emision.isin}"
                                                styleClass="readonly" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.bovedaMinus}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                            <h:selectOneMenu styleClass="readonly disabled"
                                                value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.posicionTraspasante.boveda}"
                                                id="boveda" converter="bovedaConverter" tabindex="75"   >                                               
                                                <f:selectItems value="#{seleccionarEmisionCapitalesBean.bovedasValor}" />
                                            </h:selectOneMenu>
                                        </td>
                                    </tr>
                                    <!-- Este campo no es usado por el momento tr>
                                        <td>
                                            <h:panelGroup rendered="#{!traspasoMiscelaneaFiscalCapitalesBean.recepcion}">
                                                <h:outputText value="#{etq.precioVector}" styleClass="texto" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                            <h:inputText autocomplete="off" id="precioVector" size="30" maxlength="30"
                                                value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.precioVector}"
                                                styleClass="readonly" converter="formatoMonedaConverter"
                                                rendered="#{!traspasoMiscelaneaFiscalCapitalesBean.recepcion}">
                                            </h:inputText>
                                        </td>
                                    </tr-->
                                    <tr>
                                        <td>
                                            <h:panelGroup rendered="#{!traspasoMiscelaneaFiscalCapitalesBean.recepcion}">
                                                <h:outputText value="#{etq.saldoDisponibleMinus}" styleClass="texto" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                            <h:inputText autocomplete="off" id="saldoDisponible" size="30" maxlength="30"
                                                value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.saldoDisponible}"
                                                converter="formatoEnteroConverter" styleClass="readonly"
                                                rendered="#{!traspasoMiscelaneaFiscalCapitalesBean.recepcion}">
                                            </h:inputText>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup rendered="#{!traspasoMiscelaneaFiscalCapitalesBean.recepcion}">
                                                <h:outputText value="#{etq.saldoActual}" styleClass="texto" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                            <h:inputText autocomplete="off" id="saldoActual" size="30" maxlength="30"
                                                value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.saldoActual}"
                                                converter="formatoEnteroConverter" styleClass="readonly"
                                                rendered="#{!traspasoMiscelaneaFiscalCapitalesBean.recepcion}">
                                            </h:inputText>
                                        </td>
                                    </tr>
                                </table>
                            </h:panelGroup>
                        </td>
                        <td style="vertical-align: top;">
                            <h:panelGroup id="datosOperacion">
                                <table width="100%" cellpadding="0px" cellspacing="5px">
                                    <tr>
                                        <td width="25%">
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.cantidadOperada}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>
                                        </td>
                                        <td width="75%">
                                        	<h:panelGroup id="cantidadOperacion">
                                            	<h:inputText autocomplete="off" id="cantidad" size="30" maxlength="14" converter="formatoEnteroConverter"
                                                	value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.cantidadOperada}"
                                                	tabindex="100" styleClass="campoNumerico">
                                                	<a4j:support event="onchange" reRender="saldoActual, cantidad"
                                                    	actionListener="#{traspasoMiscelaneaFiscalCapitalesBean.realizaCalculoSaldoActual}" oncomplete="establecerFoco('valorEn');"/>
                                            	</h:inputText>
                                            </h:panelGroup>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.divisa}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                        	<h:panelGroup id="divisa">
                                            	<h:selectOneMenu id="valorEn"
                                                	value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.valorEn}"
                                                	converter="divisaConverter" tabindex="110">
                                                	<f:selectItems value="#{catalogosBean.opcionesComboDivisa}" />
                                            	</h:selectOneMenu>
                                            </h:panelGroup>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="25%">
                                            <h:panelGroup>
                                               <h:outputText value="#{etq.fechaHoraCierreOperMinus}" styleClass="texto" />
                                            </h:panelGroup>
                                        </td>
                                        <td width="75%">
                                        	<rich:calendar id="fechaHoraCierreOper" 
												value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.fechaHoraCierreOper}"
												datePattern="dd/MM/yyyy HH:mm"
												inputSize="20"
												inputStyle="background-color: #ffffe6;"
												isDayEnabled="isDayEnabled" 
												/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.precioAdquisicionMinus}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>

                                        </td>
                                        <td>
                                        	<h:panelGroup id="precio">	
                                            	<h:inputText autocomplete="off" id="precioAdquisicion" size="30" maxlength="21" styleClass="campoNumericoDecimal
                                            	campoNumericoDecimalOchoDecimales campoNumericoDecimalOchoDecimales"
                                                	value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.precioAdquisicion}"
                                                	converter="formatoLargoMonedaConverter" tabindex="130" >
                                                	<a4j:support event="onchange"
														reRender="precioAdquisicion" oncomplete="establecerFoco('cliente');"/>
                                            	</h:inputText>
                                            </h:panelGroup>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.clienteMinus}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                        	<h:panelGroup id="clienteOperacion">
                                            	<h:inputText autocomplete="off" id="cliente" size="35" maxlength="35"
                                                	value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.cliente}"
                                                	tabindex="140" styleClass="texto campoAlphaEspeciales" />
                                            </h:panelGroup>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.rfcCurp}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                        	<h:panelGroup id="rfc">
                                            	<h:inputText autocomplete="off" id="rfcCurp" size="20" maxlength="18" styleClass="campoAlphaNumerico"
                                                	value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.rfcCurp}"
                                                	tabindex="150">
                                                <a4j:support event="onchange"
														     oncomplete="establecerFoco('btnGuardar');"/>	
                                                </h:inputText>
                                            </h:panelGroup>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.extranjeroMinus}" styleClass="texto" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                        	<h:panelGroup id="ext">
                                            	<h:selectBooleanCheckbox id="extranjero"
                                                	value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.aceptaCargo}"
                                                	tabindex="160" onchange="validaExtranjero()">
                                                	<a4j:support event="onchange" oncomplete="establecerFoco('btnGuardar');"/>
                                                	</h:selectBooleanCheckbox>
                                            </h:panelGroup>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:panelGroup>
                                                <h:outputText value="#{etq.costoPromedio}" styleClass="texto" />
                                                <h:outputText value="#{etq.asterisco}" styleClass="required" />
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                        	<h:panelGroup id="costo">
                                                <h:inputText autocomplete="off" id="costoPromedio" size="30" maxlength="30"
                                                	value="#{traspasoMiscelaneaFiscalCapitalesBean.traspasoMiscelaneaFiscal.costoPromedio}"
                                                	converter="formatoLargoMonedaConverter" 
                                                   	styleClass="campoNumericoDecimal campoNumericoDecimalOchoDecimales"
                                                	tabindex="170">
                                            	</h:inputText>
                                            </h:panelGroup>
                                        </td>
                                    </tr>
                                </table>
                            </h:panelGroup>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            &#160;
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <h:outputText value="#{etq.asterisco}" styleClass="required" />
                            <h:outputText value="#{etq.requeridos}" styleClass="texto" />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            &#160;
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            &#160;
                        </td>
                    </tr>
                </table>
                
                <!-- La facultad debe reflejar el valor de SeguridadConstants.FACULTAD_FIRMA_OPERACION -->
				<indeval:authorizeFaculty userInFaculty="CON_CERTIFICADO">
	                <h:panelGroup id="panelFirma">
	                    <div style="display: none">
	                        <textarea id="isoSinFirmar" name="isoSinFirmar">#{traspasoMiscelaneaFiscalCapitalesBean.isoSinFirmar}</textarea>
	                         <textarea id="numeroSerie" name="numeroSerie" ></textarea>
	                         <textarea  id="numeroSerieUsuario" name="numeroSerieUsuario">#{sessionScope.usuario.numeroSerieCertificado}</textarea>
							<textarea id="isoFirmado" name="isoFirmado"></textarea>
							<textarea  id="hashIso" name="hashIso">#{traspasoMiscelaneaFiscalCapitalesBean.hashIso}</textarea>
	                    </div>
	
	                    <h:panelGroup rendered="#{not empty traspasoMiscelaneaFiscalCapitalesBean.isoSinFirmar}">
	                        <script>                                                    
	                            function firmarOperacion(){
	                            	bloquearSeccionBotones('btnGuardar', 'btnLimpiar');
	                                $j("input[id$='btnGuardar2']").prop("disabled",false);
	                                $j("input[id$='btnGuardar2']").click();
	                                $j("input[id$='btnGuardar2']").prop("disabled",true);
	                            }
	                        </script>
	
	                        <ui:decorate template="/firmaDigitalSimple.xhtml">
	                            <ui:define name="isoSinFirmar">
	                                <h:outputText value="#{traspasoMiscelaneaFiscalCapitalesBean.isoSinFirmar}" />
	                            </ui:define>
	                        </ui:decorate>
	                    </h:panelGroup>
	                </h:panelGroup>
				</indeval:authorizeFaculty>
            </h:panelGroup>

           

        </ui:define>

        <ui:define name="botones">
       		<div class="refrescar" style="float: left;">
				<a4j:status id="commonStatus">
					<f:facet name="start">
						<h:panelGroup>
							<h:graphicImage value="/images/ajax-loader.gif" />
							<h:outputText value="#{etq.buscando}"></h:outputText>
						</h:panelGroup>
					</f:facet>
				</a4j:status>
			</div>
            <h:panelGrid width="25%">
				<h:panelGroup id="botones">
					<div class="limpiar">
						<h:commandButton id="btnLimpiar" image="/images/transparent.gif"
							styleClass="submit" 
							actionListener="#{traspasoMiscelaneaFiscalCapitalesBean.limpiar}"
							>
						</h:commandButton>
					</div>
					<div class="guardar">
						<a4j:commandButton id="btnGuardar" image="/images/transparent.gif"
							styleClass="submit" reRender="folioTraspasante, ctaTraspasante, tenenciaTraspasante, nombreInstitucionTraspasante, folioReceptor, ctaReceptor, 
							tenenciaReceptor, nombreInstitucionReceptor, cantidadOperacion, divisa, precio, clienteOperacion, rfc, ext, costo,
							botones, panelFirma, datosPosicionTraspasante"
							actionListener="#{traspasoMiscelaneaFiscalCapitalesBean.enviarOperacion}"
							onclick="if(confirmarOperacionGeneral()){removeApplet();deshabilitarBoton('btnGuardar');deshabilitarBoton('btnLimpiar');} else return false"
							oncomplete="establecerFoco('idFolioTraspasante');habilitarBoton('btnGuardar');habilitarBoton('btnLimpiar');" tabindex="170">							
						</a4j:commandButton>
					</div>
					<div class="guardar">
						<h:commandButton id="btnGuardar2" image="/images/transparent.gif"
							styleClass="hidden" disabled="true"
							actionListener="#{traspasoMiscelaneaFiscalCapitalesBean.enviarOperacion2}" 
							oncomplete="desbloquearSeccionBotones('btnGuardar', 'btnLimpiar');"
							tabindex="180">
						</h:commandButton>
					</div>
				</h:panelGroup>
			</h:panelGrid>
        </ui:define>

    </ui:composition>

</html>
