<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xls="http://indeval.com/jsf/xls" xmlns:a4j="http://richfaces.org/a4j" xmlns:cvt="http://indeval.com/jsf/converters" xmlns:f="http://java.sun.com/jsf/core">	

<xls:document  documentName="consultarRecuperaciones" documentTitle="Consulta Recuperaciones"
	institucion="#{consultaRecuperacionesController.institucionActual.nombreCorto}"
	fecha="#{consultaRecuperacionesController.fechaActual}" >

	<!-- Criterios de consulta -->
	<xls:table value="#{consultaRecuperacionesController}" var="criterios"  >
		<xls:row>
			<xls:col header="#{etq.participante}"
				value="#{empty consultaRecuperacionesController.consultaRecuperacionDTO.participante?  'TODAS': consultaRecuperacionesController.consultaRecuperacionDTO.participante}"></xls:col>
			<xls:col header="#{etq.contraparte}"
				value="#{empty consultaRecuperacionesController.consultaRecuperacionDTO.contraparte ? 'TODAS': consultaRecuperacionesController.consultaRecuperacionDTO.contraparte}"></xls:col>
			<xls:col header="#{etq.tipoValor}"
				value="#{empty consultaRecuperacionesController.consultaRecuperacionDTO.tipoValor ? 'TODAS': consultaRecuperacionesController.consultaRecuperacionDTO.tipoValor}"></xls:col>
			<xls:col header="#{etq.emisora}"
				value="#{empty consultaRecuperacionesController.consultaRecuperacionDTO.emisora ? 'TODAS': consultaRecuperacionesController.consultaRecuperacionDTO.emisora}"></xls:col>
			<xls:col header="#{etq.serie}"
				value="#{empty consultaRecuperacionesController.consultaRecuperacionDTO.serie ? 'TODAS' : consultaRecuperacionesController.consultaRecuperacionDTO.serie}"></xls:col>
			<xls:col header="#{etq.cupon}"
				value="#{empty consultaRecuperacionesController.consultaRecuperacionDTO.cupon ? 'TODAS' : consultaRecuperacionesController.consultaRecuperacionDTO.cupon}"></xls:col>
			<xls:col header="#{etq.folioRecu}"
				value="#{empty consultaRecuperacionesController.consultaRecuperacionDTO.recuperacion ? 'TODAS' : consultaRecuperacionesController.consultaRecuperacionDTO.recuperacion}"></xls:col>				
		
			<xls:col header="#{etq.moduloOrigen}"
				value="#{consultaRecuperacionesController.consultaRecuperacionDTO.idModuloOrigen == -1 ? 'TODAS' : consultaRecuperacionesController.descripcionModuloOrigen}" ></xls:col>
			<xls:col header="#{etq.tipoMovimiento}"
				value="#{consultaRecuperacionesController.consultaRecuperacionDTO.idTipoMovimiento == -1 ? 'TODAS' : consultaRecuperacionesController.descripcionIdTipoMovimiento}"></xls:col>
			<xls:col header="#{etq.fechaInicialSinPuntos}"
				value="#{consultaRecuperacionesController.consultaRecuperacionDTO.fechaInicial}"
				pattern="dd/MM/yyyy"></xls:col>
			<xls:col header="#{etq.fechaFinalSinPuntos}"
				value="#{consultaRecuperacionesController.consultaRecuperacionDTO.fechaFinal}"
				pattern="dd/MM/yyyy"></xls:col>
		</xls:row>
	</xls:table>
		<!-- Resultados tabla -->
	
	<xls:table value="#{consultaRecuperacionesController.resultados}" var="resultado" >
			<xls:row>
				<xls:col header="#{etq.traspasante}" value="#{resultado.traspasante}"  ></xls:col>
				<xls:col header="#{etq.cuentaTraspasante}" value="#{resultado.cuentaTraspasante}" ></xls:col>
				<xls:col header="#{etq.receptor}" value="#{resultado.receptor}"></xls:col>
				<xls:col header="#{etq.cuentaReceptor}" value="#{resultado.cuentaReceptor}" ></xls:col>
				<xls:col header="#{etq.referenciaOperacion}" value="#{resultado.referenciaOperacion}"></xls:col>
				
				<xls:col header="#{etq.tipoValor}" value="#{resultado.tv}"></xls:col>
				<xls:col header="#{etq.emisora}" value="#{resultado.emisora}"></xls:col>
				<xls:col header="#{etq.serie}" value="#{resultado.serie}"></xls:col>
				<xls:col header="#{etq.cupon}" value="#{resultado.cupon}"></xls:col>
				
				<xls:col header="#{etq.importe}" value="#{resultado.importe}" pattern="$##,##0.00"></xls:col>
				<xls:col header="#{etq.cantidadTit}" value="#{resultado.cantidadTitulos}" pattern="#,##0"></xls:col>
				<xls:col header="#{etq.moduloOrigen}" value="#{resultado.moduloOrigen}" ></xls:col>
				<xls:col header="#{etq.tipoMovimiento}" value="#{resultado.tipoMovimientoOrigen}"  ></xls:col>
				<xls:col header="#{etq.folioRecu}" value="#{resultado.folioRecuperacion}"  ></xls:col>
				<xls:col header="#{etq.fechaMovimiento}" value="#{resultado.fechaMovimiento}"  pattern="dd/MM/yyyy" ></xls:col>
				<xls:col header="#{etq.estadoMovimiento}" value="#{resultado.estadoMovimiento}"  ></xls:col>
			</xls:row>
	</xls:table>
	
	<xls:table value="#{consultaRecuperacionesController.cantidadTotal}" var="condiciones1" align="center" >	
		<xls:row>
			<xls:col header="#{etq.monto}" value="#{consultaRecuperacionesController.montoTotal}" align="center" pattern="$##,##0.00"/>
			<xls:col header="#{etq.cantidad}" value="#{consultaRecuperacionesController.cantidadTotal}" align="center" pattern="##,##0"/>
		</xls:row>
	</xls:table>
			

</xls:document>
</html>