<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:pdf="http://indeval.com/jsf/pdf"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:cvt="http://indeval.com/jsf/converters">
	
	<pdf:document documentName="consultaMovimientosValor"
		      documentTitle="Consulta de Movimientos de Valores"
		      institucion="#{consultaMovimientosValorBean.institucionActual.claveTipoInstitucion} #{consultaMovimientosValorBean.institucionActual.folioInstitucion} #{consultaMovimientosValorBean.institucionActual.razonSocial}"
		      fecha="#{consultaMovimientosValorBean.fechaActual}"
		      imageResource="/images/indeval.png" landscape="true">
		
		<pdf:table value="#{consultaMovimientosValorBean.consultaMovimientos}"
			   currentBean="consulta">
		
			<pdf:row>
				<pdf:col header="#{etq.naturalezaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.cuentaSeleccionada.tipoTenencia.tipoNaturaleza.descripcion}" align="center" />
				<pdf:col header="#{etq.institucionMinus}"
					 value="#{consultaMovimientosValorBean.folioClaveInstitucion}" align="center" />
				<pdf:col header="#{etq.cuentaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.cuentaSeleccionada.descripcion}" align="center"  />
				<pdf:col header="#{etq.tipoCuentaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.cuentaSeleccionada.tipoTenencia.tipoCuenta.descripcion}" align="center" />
				<pdf:col header="#{etq.tipoTenenciaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.cuentaSeleccionada.tipoTenencia.descripcion}" align="center" />
				<pdf:col header="#{etq.rolMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.descripcionRolParticipante}" align="center" />
				<pdf:col header="#{etq.tipoMercadoMinus}"
					 value="#{consultaMovimientosValorBean.descripcionPapelMercado}" align="center" />
				<pdf:col header="#{etq.papelMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.tipoValor.mercado.descripcion}" align="center" />
				<pdf:col header="#{etq.isin}"
					 value="#{empty consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.isin ? 'TODOS' : consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.isin}" align="center" />
				<pdf:col header="#{etq.tv}"
					 value="#{empty consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.tipoValor.claveTipoValor ? 'TODOS' : consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.tipoValor.claveTipoValor}" align="center" />
				<pdf:col header="#{etq.emisoraMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.emisora.descripcion}" align="center" />
				<pdf:col header="#{etq.serieMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.serie.descripcion}" align="center" />
				<pdf:col header="#{etq.bovedaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.bovedaSeleccionada.descripcion}" align="center" />
					 <pdf:col header="#{etq.naturalezaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuentaContraparte.opcionSeleccionada.tipoTenencia.tipoNaturaleza.descripcion}" align="center" />
				<pdf:col header="#{etq.tipoCuentaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuentaContraparte.opcionSeleccionada.tipoTenencia.tipoCuenta.descripcion}" align="center" />
				<pdf:col header="#{etq.tipoTenenciaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuentaContraparte.opcionSeleccionada.tipoTenencia.descripcion}" align="center" />
				<pdf:col header="#{etq.cuentaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuentaContraparte.opcionSeleccionada.descripcion}" align="center" />
				<pdf:col header="#{etq.rolMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.descripcionRolContraparte}" align="center" />
					<pdf:col header="#{etq.tipoInstruccionMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioTipoInstruccion.opcionSeleccionada.nombreCorto}" align="center" />
				<pdf:col header="#{etq.tipoOp}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioTipoOperacion.opcionSeleccionada.claveTipoOperacion}" align="center" />
				<pdf:col header="#{etq.folioInstruccionMinus}"
					 value="#{empty consultaMovimientosValorBean.consultaMovimientos.criterioFolioInstruccion ?  'TODOS' : consultaMovimientosValorBean.consultaMovimientos.criterioFolioInstruccion}" align="center" />
				<pdf:col header="#{etq.ordenamientoTipoInstruccion}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.ordenarPorTipoDeInstruccion?'SI':'NO'}" align="center" />
				<pdf:col header="#{etq.registrosEncontrados}"
				value="#{consultaMovimientosValorBean.totalResultados}" align="center"/>
			</pdf:row>
			
		</pdf:table>	
	
		
		
		
		<pdf:iterator
			     value="#{consultaMovimientosValorBean.resultadosEstadoCuentaPosicion}"
			     var="estadoCuentaPosicionPorEmision">
			     
			     <pdf:table value="#{estadoCuentaPosicionPorEmision}"
					   currentBean="dummy">
					<pdf:row>
						<pdf:col header="#{etq.emision}" value="" />
						<pdf:col
							header="#{estadoCuentaPosicionPorEmision.emision.tipoValor.claveTipoValor} | #{estadoCuentaPosicionPorEmision.emision.emisora.descripcion} | #{estadoCuentaPosicionPorEmision.emision.serie.serie} | #{estadoCuentaPosicionPorEmision.emision.isin}"
							value="" />
					</pdf:row>
				</pdf:table>
			     
			<pdf:iterator
				     value="#{estadoCuentaPosicionPorEmision.detallesBoveda}"
				     var="estadoCuentaPosicionPorBoveda">
				
				<pdf:table value="#{estadoCuentaPosicionPorBoveda}"
					   currentBean="dummy"
					   rendered="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuenta.opcionSeleccionada.tipoTenencia.tipoCuenta.id eq 'C'}">
					<pdf:row>
						<pdf:col header="#{etq.boveda}" value="" />
						<pdf:col
							header="#{estadoCuentaPosicionPorBoveda.boveda.descripcion}"
							value="" />
					</pdf:row>
				</pdf:table>
				
				<pdf:table value="#{estadoCuentaPosicionPorBoveda}"
					   currentBean="dummy"
					   rendered="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuenta.opcionSeleccionada.tipoTenencia.tipoCuenta.id eq 'N'}">
					<pdf:row>
						<pdf:col header="#{etq.boveda}" value="" />
						<pdf:col
							header="#{estadoCuentaPosicionPorBoveda.boveda.descripcion}"
							value="" />
					</pdf:row>
				</pdf:table>
				
				<pdf:table
					  value="#{estadoCuentaPosicionPorBoveda.registrosContablesControladas}"
					  currentBean="registroContable"
					  rendered="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuenta.opcionSeleccionada.tipoTenencia.tipoCuenta.id eq 'C'}">
					<pdf:row>
						<pdf:col header="#{etq.fechaLiquidacion}"
							 value="#{registroContable.fecha}" align="center" >
							 <cvt:simpleDateConverter pattern="dd/MM/yyyy"/>
					    </pdf:col>
						<pdf:col header="#{etq.descripcion}"
							 value="#{registroContable.descripcion}" align="center" />
						<pdf:col header="#{etq.cupon}"
							 value="#{registroContable.cupon.claveCupon}" align="center" />
						<pdf:col header="#{etq.recepcionMinus}"
							 value="#{empty registroContable.cantidadRecepcion ? 0 : registroContable.cantidadRecepcion}" align="right">
							<f:convertNumber pattern="#,###,###,###,###,###,###,##0" />
						</pdf:col>
						<pdf:col header="#{etq.entrega}"
							 value="#{empty registroContable.cantidadEntrega ? 0 : registroContable.cantidadEntrega}" align="right">
							<f:convertNumber pattern="#,###,###,###,###,###,###,##0" />
						</pdf:col>
					</pdf:row>
				</pdf:table>
				
				<pdf:table
					  value="#{estadoCuentaPosicionPorBoveda.registrosContablesNombradas}"
					  currentBean="registroContable"
					  rendered="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuenta.opcionSeleccionada.tipoTenencia.tipoCuenta.id eq 'N'}">
					<pdf:row>
						<pdf:col header="#{etq.fechaLiquidacion}"
							 value="#{registroContable.fecha}" align="center" >
							<cvt:simpleDateConverter pattern="dd/MM/yyyy kk:mm:ss" />
						</pdf:col>
						<pdf:col header="#{etq.descripcion}"
							 value="#{registroContable.descripcion}" align="center" />
						<pdf:col header="#{etq.participanteId}"
							 value="#{registroContable.claveTipoInstitucionParticipante}" />
						<pdf:col header="#{etq.participanteFolio}"
							 value="#{registroContable.folioInstitucionParticipante}" />
						<pdf:col header="#{etq.participanteCuenta}"
							 value="#{registroContable.numeroCuentaParticipante}" />
						<pdf:col header="#{etq.contraparteId}"
							 value="#{registroContable.claveTipoInstitucionContraparte}" />
						<pdf:col header="#{etq.contraparteFolio}"
							 value="#{registroContable.folioInstitucionContraparte}" />
						<pdf:col header="#{etq.contraparteCuenta}"
							 value="#{registroContable.numeroCuentaContraparte}" />
						<pdf:col header="#{etq.cupon}"
							 value="#{registroContable.cupon.claveCupon}" align="center" />
						<pdf:col header="#{etq.folioInstruccion}"
							 value="#{registroContable.operacion.instruccionLiquidacion.folioInstruccion}" />
							<pdf:col header="#{etq.tipoInstruccion}" value="#{registroContable.operacion.instruccionLiquidacion.tipoInstruccion.nombreCorto}"/>
						<pdf:col header="#{etq.recepcionMinus}"
							 value="#{empty registroContable.cantidadRecepcion ? 0 : registroContable.cantidadRecepcion}" align="right">
							<f:convertNumber pattern="#,###,###,###,###,###,###,##0" />
						</pdf:col>
						<pdf:col header="#{etq.entrega}"
							 value="#{empty registroContable.cantidadEntrega ? 0 : registroContable.cantidadEntrega}" align="right">
							<f:convertNumber pattern="#,###,###,###,###,###,###,##0" />
						</pdf:col>
					</pdf:row>
				</pdf:table>
				
			</pdf:iterator>
			
			
		</pdf:iterator>
	</pdf:document>
</html>
