<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:xls="http://indeval.com/jsf/xls"
	xmlns:a4j="http://richfaces.org/a4j">
	<xls:document documentName="consultaMovimientosValor"
		documentTitle="Consulta de Movimientos de Valores"
		institucion="#{consultaMovimientosValorBean.institucionActual.claveTipoInstitucion} #{consultaMovimientosValorBean.institucionActual.folioInstitucion} #{consultaMovimientosValorBean.institucionActual.razonSocial}"
		fecha="#{consultaMovimientosValorBean.fechaActual}">
 

		<xls:table value="#{consultaMovimientosValorBean.consultaMovimientos}"
				   var="consulta">
			<xls:row>
				<xls:col header="Datos participante" collspan="6"/>
				<xls:col/>
				<xls:col/>
				<xls:col/>
				<xls:col/>
				<xls:col/>
				<xls:col header="Emision" align="center" collspan="7"/>
				<xls:col/>
				<xls:col/>
				<xls:col/>
				<xls:col/>
				<xls:col/>
				<xls:col/>
				<xls:col header="Datos Receptor" collspan="5"/>
				<xls:col/>
				<xls:col/>
				<xls:col/>
				<xls:col/>
				<xls:col header="Instruccion" collspan="4"/>
				<xls:col/>
				<xls:col/>
				<xls:col/>
			</xls:row>
			<xls:row>
				<xls:col header="#{etq.naturalezaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.cuentaSeleccionada.tipoTenencia.tipoNaturaleza.descripcion}" align="center" />
				<xls:col header="#{etq.institucionMinus}"
					 value="#{consultaMovimientosValorBean.folioClaveInstitucion}" align="center" />
				<xls:col header="#{etq.cuentaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.cuentaSeleccionada.descripcion}" align="center"  />
				<xls:col header="#{etq.tipoCuentaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.cuentaSeleccionada.tipoTenencia.tipoCuenta.descripcion}" align="center" />
				<xls:col header="#{etq.tipoTenenciaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.cuentaSeleccionada.tipoTenencia.descripcion}" align="center" />
				<xls:col header="#{etq.rolMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.descripcionRolParticipante}" align="center" />
				<xls:col header="#{etq.tipoMercadoMinus}"
					 value="#{consultaMovimientosValorBean.descripcionPapelMercado}" align="center" />
				<xls:col header="#{etq.papelMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.tipoValor.mercado.descripcion}" align="center" />
				<xls:col header="#{etq.isin}"
					 value="#{empty consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.isin ? 'TODOS' : consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.isin}" align="center" />
				<xls:col header="#{etq.tv}"
					 value="#{empty consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.tipoValor.claveTipoValor ? 'TODOS' : consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.tipoValor.claveTipoValor}" align="center" />
				<xls:col header="#{etq.emisoraMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.emisora.descripcion}" align="center" />
				<xls:col header="#{etq.serieMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioEmision.opcionSeleccionada.serie.descripcion}" align="center" />
				<xls:col header="#{etq.bovedaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.bovedaSeleccionada.descripcion}" align="center" />
					<xls:col header="#{etq.naturalezaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuentaContraparte.opcionSeleccionada.tipoTenencia.tipoNaturaleza.descripcion}" align="center" />
				<xls:col header="#{etq.tipoCuentaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuentaContraparte.opcionSeleccionada.tipoTenencia.tipoCuenta.descripcion}" align="center" />
				<xls:col header="#{etq.tipoTenenciaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuentaContraparte.opcionSeleccionada.tipoTenencia.descripcion}" align="center" />
				<xls:col header="#{etq.cuentaMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuentaContraparte.opcionSeleccionada.descripcion}" align="center" />
				<xls:col header="#{etq.rolMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.descripcionRolContraparte}" align="center" />				
					<xls:col header="#{etq.tipoInstruccionMinus}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioTipoInstruccion.opcionSeleccionada.nombreCorto}" align="center" />
				<xls:col header="#{etq.tipoOp}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.criterioTipoOperacion.opcionSeleccionada.claveTipoOperacion}" align="center" />
				<xls:col header="#{etq.folioInstruccionMinus}"
					 value="#{empty consultaMovimientosValorBean.consultaMovimientos.criterioFolioInstruccion ?  'TODOS' : consultaMovimientosValorBean.consultaMovimientos.criterioFolioInstruccion}" align="center" />
				<xls:col header="#{etq.ordenamientoTipoInstruccion}"
					 value="#{consultaMovimientosValorBean.consultaMovimientos.ordenarPorTipoDeInstruccion?'SI':'NO'}" align="center" />
			</xls:row>
		</xls:table >
		
	       <xls:table value="#{consultaMovimientosValorBean.consultaMovimientos}" var="header2">
	           <xls:row>
	           	<xls:col header="#{etq.registrosEncontrados}" value="#{consultaMovimientosValorBean.totalResultados}" align="center"/>
	           </xls:row>
	       </xls:table>
		
		<xls:table
			value="#{consultaMovimientosValorBean.resultadosControladasReporteXls}"
			var="controlada"
			rendered="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuenta.opcionSeleccionada.tipoTenencia.tipoCuenta.id eq 'C'}"> 
	       	<xls:row>
	       		<xls:col header="#{etq.fechaLiquidacion}" value="#{controlada.fecha}" pattern="dd/MM/yyyy HH:mm:ss" />
	       		<xls:col header="#{etq.descripcion}" value="#{controlada.descripcion}" />
				<xls:col header="#{etq.id}" value="#{controlada.posicion.cuenta.institucion.claveTipoInstitucion}" />
				<xls:col header="#{etq.folio}" value="#{controlada.posicion.cuenta.institucion.folioInstitucion}" />
				<xls:col header="#{etq.cuentaMinus}" value="#{controlada.posicion.cuenta.cuenta}" />
				<xls:col header="#{etq.tv}" value="#{controlada.posicion.emision.tipoValor.descripcion}" />
				<xls:col header="#{etq.emisora}" value="#{controlada.posicion.emision.emisora.descripcion}" />
				<xls:col header="#{etq.serie}" value="#{controlada.posicion.emision.serie.serie}" />
				<xls:col header="#{etq.cupon}" value="#{controlada.cupon.claveCupon}" />
				<xls:col header="#{etq.isin}" value="#{controlada.posicion.emision.isin}" />
				<xls:col header="#{etq.boveda}" value="#{controlada.posicion.boveda.descripcion}" />
				<xls:col header="#{etq.recepcionMinus}" value="#{empty controlada.cantidadRecepcion ? 0 : controlada.cantidadRecepcion}" pattern="#,###,###,###,###,###,###,##0" />
				<xls:col header="#{etq.entregaMinus}" value="#{empty controlada.cantidadEntrega ? 0 : controlada.cantidadEntrega}" pattern="#,###,###,###,###,###,###,##0" />
			</xls:row>
		</xls:table>
	
		<xls:table
			value="#{consultaMovimientosValorBean.resultadosNombradasReporteXls}"
			var="nombrada"
			rendered="#{consultaMovimientosValorBean.consultaMovimientos.criterioCuenta.opcionSeleccionada.tipoTenencia.tipoCuenta.id eq 'N'}"> 
	       	<xls:row>
	       		<xls:col header="#{etq.fechaLiquidacion}" value="#{nombrada.fecha}" pattern="dd/MM/yyyy HH:mm:ss"/>
	       		<xls:col header="#{etq.descripcion}" value="#{nombrada.descripcion}" />
	       		<xls:col header="#{etq.participanteId}" value="#{nombrada.claveTipoInstitucionParticipante}" />
				<xls:col header="#{etq.participanteFolio}" value="#{nombrada.folioInstitucionParticipante}" />
				<xls:col header="#{etq.participanteCuenta}" value="#{nombrada.numeroCuentaParticipante}" />
				<xls:col header="#{etq.contraparteId}" value="#{nombrada.claveTipoInstitucionContraparte}" />
				<xls:col header="#{etq.contraparteFolio}" value="#{nombrada.folioInstitucionContraparte}" />
				<xls:col header="#{etq.contraparteCuenta}" value="#{nombrada.numeroCuentaContraparte}" />
				<xls:col header="#{etq.recepcionMinus}" value="#{empty nombrada.cantidadRecepcion ? 0 : nombrada.cantidadRecepcion}" pattern="#,###,###,###,###,###,###,##0" />
				<xls:col header="#{etq.entregaMinus}" value="#{empty nombrada.cantidadEntrega ? 0 : nombrada.cantidadEntrega}" pattern="#,###,###,###,###,###,###,##0" />
				<xls:col header="#{etq.tv}" value="#{nombrada.posicion.emision.tipoValor.claveTipoValor}" />
				<xls:col header="#{etq.emisora}" value="#{nombrada.posicion.emision.emisora.descripcion}" />
				<xls:col header="#{etq.serie}" value="#{nombrada.posicion.emision.serie.descripcion}" />
				<xls:col header="#{etq.cupon}" value="#{nombrada.cupon.claveCupon}" />
				<xls:col header="#{etq.isin}" value="#{nombrada.posicion.emision.isin}" />
		    	<xls:col header="#{etq.folioInstruccion}" value="#{nombrada.operacion.instruccionLiquidacion.folioInstruccion}" pattern="##############" />
				<xls:col header="#{etq.tipoInstruccion}" value="#{nombrada.operacion.instruccionLiquidacion.tipoInstruccion.nombreCorto}"/>
				<xls:col header="#{etq.boveda}" value="#{nombrada.posicion.boveda.descripcion}" />
			</xls:row>
		</xls:table>
	</xls:document>
</html>