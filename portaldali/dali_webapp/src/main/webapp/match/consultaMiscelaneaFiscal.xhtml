<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:t="http://myfaces.apache.org/tomahawk"
    xmlns:indeval="http://indeval.com/indeval"
    xml:lang="en" lang="en">

    <ui:composition template="/layoutConsultas.xhtml">
		
        <ui:define name="head">
        	<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/consultaBitacoraEnvOp.js" />
            <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/consultaPosiciones.js" />
			<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/mostrarPosiciones.js" />			
        </ui:define>
        
        <ui:define name="tituloSeccion">
            <h:outputText value="#{etq.consultaMiscelaneaFiscal}" />
        </ui:define>
       
        <ui:define name="criterios">
            <a4j:keepAlive beanName="consultaMiscelaneaFiscalBean"/>
            <h:panelGroup id="init">
           		<h:outputText value="#{consultaMiscelaneaFiscalBean.init}"/>
			</h:panelGroup>
            <h:panelGroup id="panelCriterios">
                <div style='display: "inline"' id="divCriterios">
                    <table width="900" border="0" cellpadding="0px" cellspacing="5px" align="center">
                        <tr>
                            <td class="recuadroTabla">
                                <table class="tablaCriterios" >
                                    <tr align="center">
                                        <td colspan="2" align="center">
                                            <b> <h:outputText styleClass="texto" value="#{etq.participanteMinus}" /> </b>
                                        </td>
                                    </tr>
                                    <tr align="center">
                                        <td>
                                            <h:outputText styleClass="texto" value="#{etq.participanteMinus}" />
                                        </td>
                                        <td>
                                            <h:outputText styleClass="texto" value="#{etq.cuentaMinus}" />
                                        </td>
                                        <td>
                                            <h:outputText styleClass="texto" value="#{etq.nombreCuenta}" />
                                        </td>
                                    </tr>
                                    <tr align="center">
                                        <td>
                                            <h:panelGroup>
                                                <h:inputText autocomplete="off" id="idFolioTraspasante"
                                                    value="#{consultaMiscelaneaFiscalBean.idFolioTraspasante}" size="5" maxlength="5"
                                                    styleClass="#{consultaMiscelaneaFiscalBean.editarTraspasante ?'campoNumericoAsterisco':'readonly'} campoNumericoAsterisco textoControles"  
                                                    tabindex="10"/>
                                                <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="idFolioTraspasante"
                                                    suggestionAction="#{seleccionarCuentaBean.buscarParticipante}"
                                                    var="coincidencia"
                                                    fetchValue="#{coincidencia.claveTipoInstitucion}#{coincidencia.folioInstitucion}"
                                                    minChars="1" width="200" nothingLabel="Sin coincidencias">
                                                    <h:column>
                                                        <h:outputText
																value="#{coincidencia.claveTipoInstitucion}#{coincidencia.folioInstitucion}" /> - 
														<h:outputText value="#{coincidencia.nombreCorto}" />
													</h:column>
                                                </rich:suggestionbox>
                                            </h:panelGroup>

                                        </td>
                                        <td>
                                            <h:panelGroup>
                                                <h:inputText autocomplete="off" id="cuentaParticipante" size="4"
                                                    styleClass="textoControles textoCuenta campoNumericoAsterisco"
                                                    readonly="false" value="#{consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.cuenta}"
                                                    tabindex="20">
                                                  	<a4j:support event="onchange" reRender="init, nombreCuentaParticipante"/>
                                                </h:inputText>
                                                <input type="hidden" id="nombre_id_folio_traspasante"
                                                    name="nombre_id_folio_traspasante" value="daliForm:idFolioTraspasante" />
                                                <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="cuentaParticipante"
                                                    suggestionAction="#{seleccionarCuentaBean.buscarCuentaTraspasante}"
                                                    var="coincidencia" fetchValue="#{coincidencia.cuenta}" minChars="1"
                                                    width="80" nothingLabel="Sin coincidencias">
                                                    <h:column>
                                                        <h:outputText styleClass="texto" value="#{coincidencia.cuenta}" />
                                                    </h:column>
													<a4j:support event="onselect" reRender="init, nombreCuentaParticipante" />
                                                </rich:suggestionbox>
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                        	<h:inputText autocomplete="off" id="nombreCuentaParticipante" size="40" styleClass="textoControles"
		                                    	value="#{consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.nombreCuenta}"
		                                    readonly="true" />
                                        </td>
                                    </tr>
                                    
                                    <!-- Se agrega CONTRAPARTE -->
                                    <tr align="center">
                                        <td colspan="2" align="center">
                                            <b> <h:outputText styleClass="texto" value="#{etq.contraparteMinus}" /> </b>
                                        </td>
                                    </tr>
                                    
                                    <tr align="center">
                                        <td>
                                            <h:outputText styleClass="texto" value="#{etq.contraparteMinus}" />
                                        </td>
                                        <td>
                                            <h:outputText styleClass="texto" value="#{etq.cuentaMinus}" />
                                        </td>
                                        <td>
                                            <h:outputText styleClass="texto" value="#{etq.nombreCuenta}" />
                                        </td>
                                    </tr>
                                    
                                    <tr align="center">
                                        <td>
                                            <h:panelGroup>
                                                <h:inputText autocomplete="off" id="idFolioContraparte"
                                                    value="#{consultaMiscelaneaFiscalBean.idFolioContraparte}" size="5" maxlength="5"
                                                    styleClass="campoNumericoAsterisco textoControles"  
                                                    tabindex="30"/>
                                                <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="idFolioContraparte"
                                                    suggestionAction="#{seleccionarCuentaBean.buscarParticipante}"
                                                    var="coincidencia"
                                                    fetchValue="#{coincidencia.claveTipoInstitucion}#{coincidencia.folioInstitucion}"
                                                    minChars="1" width="200" nothingLabel="Sin coincidencias">
                                                    <h:column>
                                                        <h:outputText
																value="#{coincidencia.claveTipoInstitucion}#{coincidencia.folioInstitucion}" /> - 
														<h:outputText value="#{coincidencia.nombreCorto}" />
													</h:column>
                                                </rich:suggestionbox>
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                            <h:panelGroup>
                                                <h:inputText autocomplete="off" id="cuentaContraparte" size="4"
                                                    styleClass="textoControles textoCuenta campoNumericoAsterisco"
                                                    readonly="false" value="#{consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.cuenta}"
                                                    tabindex="40">
                                                  	<a4j:support event="onchange" reRender="init, nombreCuentaContraparte"/>
                                                </h:inputText>
                                                <input type="hidden" id="nombre_id_folio_receptor"
                                                    name="nombre_id_folio_receptor" value="daliForm:idFolioContraparte" />
                                                <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="cuentaContraparte"
                                                    suggestionAction="#{seleccionarCuentaBean.buscarCuentaReceptor}"
                                                    var="coincidencia" fetchValue="#{coincidencia.cuenta}" minChars="1"
                                                    width="80" nothingLabel="Sin coincidencias">
                                                    <h:column>
                                                        <h:outputText styleClass="texto" value="#{coincidencia.cuenta}" />
                                                    </h:column>
													<a4j:support event="onselect" reRender="init, nombreCuentaContraparte" />
                                                </rich:suggestionbox>
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                        	<h:inputText autocomplete="off" id="nombreCuentaContraparte" size="40" styleClass="textoControles"
		                                    	value="#{consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.nombreCuenta}"
		                                    readonly="true" />
                                        </td>
                                    </tr>
                                    
                                </table>
                            </td>
                            <td class="recuadroTabla" align="center">
                                <table class="tablaCriterios" align="center">
                                    <tr>
                                        <td colspan="4" align="center">
                                            <b> <h:outputText styleClass="texto" value="#{etq.claveValor}" /> </b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="center">
                                            <h:outputText styleClass="texto" value="#{etq.tv}" />
                                        </td>
                                        <td align="center">
                                            <h:outputText styleClass="texto" value="#{etq.emisoraMinus}" />
                                        </td>
                                        <td align="center">
                                            <h:outputText styleClass="texto" value="#{etq.serieMinus}" />
                                        </td>                                        
                                    </tr>
                                    <tr align="center">
                                        <td>
                                            <h:panelGroup>
                                                <h:inputText autocomplete="off" id="tipoValor" value="#{consultaMiscelaneaFiscalBean.criterio.emision.tipoValor.claveTipoValor}"
                                                    size="7" maxlength="4"
                                                    styleClass="textoControles textoTipoValor campoAlphaNumericoAsterisco"
                                                    tabindex="50" />
                                                <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="tipoValor"
                                                    suggestionAction="#{seleccionarEmisionAmbosBean.buscarTiposValorPorPrefijo}"
                                                    var="coincidencia" fetchValue="#{coincidencia.claveTipoValor}" minChars="1"
                                                    width="300" immediate="false" nothingLabel="Sin coincidencias">
                                                    <h:column>
                                                        <h:outputText value="#{coincidencia.claveTipoValor}" /> - <h:outputText
                                                            value="#{coincidencia.descripcion}" />
                                                    </h:column>
                                                </rich:suggestionbox>
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                            <h:panelGroup>
                                                <h:inputText autocomplete="off" id="emisora" value="#{consultaMiscelaneaFiscalBean.criterio.emision.emisora.descripcion}"
                                                    size="7" maxlength="7"
                                                    styleClass="textoControles campoAlphaNumericoEmisora"
                                                    tabindex="60" />
                                                <rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="emisora"
                                                    suggestionAction="#{seleccionarEmisionAmbosBean.buscarEmisorasPorPrefijo}"
                                                    var="coincidencia" fetchValue="#{coincidencia.descripcion}" minChars="1"
                                                    width="300" immediate="false" nothingLabel="Sin coincidencias">
                                                    <h:column>
                                                        <h:outputText value="#{coincidencia.descripcion}" />
                                                    </h:column>
                                                </rich:suggestionbox>
                                            </h:panelGroup>
                                        </td>
                                        <td>
                                            <h:panelGroup>
                                                <h:inputText autocomplete="off" id="serie" value="#{consultaMiscelaneaFiscalBean.criterio.emision.serie.serie}" size="7"
                                                    maxlength="6" styleClass="textoControles campoAlphaNumericoSerie"
                                                    tabindex="70" />
                                            </h:panelGroup>
                                        </td>                                        
                                    </tr>
                                    <tr>
                                    	<td colspan="3" align="center"> 
                                            <h:outputText styleClass="texto" value="#{etq.bovedaMinus}" /> 
                                        </td>
                                    </tr>
                                    <tr>
                                    	<td colspan="3" align="center">  
                                        	<h:selectOneMenu value="#{consultaMiscelaneaFiscalBean.criterio.bovedaValores}" 
                                        	     id="boveda" converter="bovedaConverter" tabindex="115"
                                        	     styleClass="textoControles textoCuenta">
			                                    <f:selectItems value="#{seleccionarEmisionBean.bovedasValor}" />
			                                </h:selectOneMenu>
                                        </td>
                                    </tr>
                                    <!-- tr>
                                        <td colspan="4">
                                            <h:panelGroup>
                                               <a href="javascript: mostrarPosiciones('Ambos');"> 
													<h:graphicImage value="/images/search.png"></h:graphicImage> 
													<h:outputText value="#{etq.buscarPosicionMinus}" styleClass="texto" /> 
												</a>&#160;&#160;&#160;
			                                   <a href="javascript:limpiarDatosPosicion();"> 
							                       	<h:graphicImage value="/images/page_refresh.png"></h:graphicImage> 
							                       	<h:outputText value="#{etq.limpiarPosicionMinus}" styleClass="texto" />
												</a>
                                            </h:panelGroup>
                                        </td>
                                    </tr-->

                                </table>
                            </td>
                            <td class="recuadroTabla" align="center">
                                <table class="tablaCriterios" align="center">
                                	<tr align="center">
                                        <td colspan="2" align="center">
                                           &#160;&#160;&#160;
                                        </td>
										<td colspan="2" align="center">
											<b> <h:outputText styleClass="texto" value="#{etq.fechaTraspaso}" /> </b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="center">
                                            <h:outputText styleClass="texto" value="#{etq.estatus}" />
                                        </td>
                                        <td align="center">
											<h:outputText styleClass="texto" value="#{etq.rolMinus}" />
										</td>
                                        <td align="center">
											<h:outputText styleClass="texto" value="#{etq.inicial}" />
                                        </td>
										<td align="center">
											<h:outputText styleClass="texto" value="#{etq.final}" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="center">
											<h:inputText autocomplete="off" id="selectEstatus" size="4" maxlength="2"
												styleClass="textoControles campoAlphaAsterisco"
												value="#{consultaMiscelaneaFiscalBean.criterio.estadoInstruccion.claveEstadoInstruccion}"
												title="#{consultaMiscelaneaFiscalBean.criterio.estadoInstruccion.descripcion}"
												tabindex="80"/>
											<rich:suggestionbox selectValueClass="autoCompleteSeleccionado"  for="selectEstatus"
												suggestionAction="#{consultaMiscelaneaFiscalBean.buscarEstadoInstruccionPorPrefijo}"
												var="coincidencia" fetchValue="#{coincidencia.claveEstadoInstruccion}"
												minChars="0" width="450" nothingLabel="Sin coincidencias" eventsQueue="tipoInstrucQueue" ignoreDupResponses="true" requestDelay="300"
												>
												<h:column>
													<h:outputText value="#{coincidencia.claveEstadoInstruccion}" /> - <h:outputText
														value="#{coincidencia.descripcion}" />
												</h:column>
											</rich:suggestionbox>
										</td>
                                        <td align="center">
											<h:selectOneMenu value="#{consultaMiscelaneaFiscalBean.criterio.rol}"
												id="selectRol" styleClass="textoControles" tabindex="90">
												<f:selectItem itemLabel="AMBOS" itemValue="0" />
												<f:selectItem itemLabel="TRASPASANTE" itemValue="1" />
												<f:selectItem itemLabel="RECEPTOR" itemValue="2" />
											</h:selectOneMenu>
											<h:message for="selectRol" />
										</td>
                                        <td>
											<rich:calendar id="fechaConcertacionInicial" 
												value="#{consultaMiscelaneaFiscalBean.criterio.fechaInicioPeriodo}"
												datePattern="dd/MM/yyyy"
												inputSize="11"
												inputClass="textoControles"
												inputStyle="background-color: #ffffe6;"
												isDayEnabled="isDayEnabled" />
			                            </td>
										<td>
											<rich:calendar id="fechaConcertacionfinal" 
												value="#{consultaMiscelaneaFiscalBean.criterio.fechaFinPeriodo}"
												datePattern="dd/MM/yyyy"
												inputSize="11"
												inputClass="textoControles"
												inputStyle="background-color: #ffffe6;"
												isDayEnabled="isDayEnabled" />
			                            </td>
                                    </tr>
                                    <!-- Se agrega MERCADO -->
                                    <tr>
                                        <td align="center">
											<h:outputText styleClass="texto" value="#{etq.mercadoMinus}" />
										</td>
										<td align="center">
											<h:outputText styleClass="texto" value="#{etq.papelMinus}" />
										</td>
										<td colspan="2">&#160;</td>
                                    </tr>
                                    <tr>
                                        <td align="center">
											<h:selectOneMenu value="#{consultaMiscelaneaFiscalBean.papelMercado}" styleClass="textoControles" id="selectPapelMercado">
												<f:selectItems value="#{consultaMiscelaneaFiscalBean.consultaCatalogos.selectItemsPapelMercado}"/>
												<a4j:support event="onchange" reRender="selectMercado" />
											</h:selectOneMenu>
										</td>
										<td align="center">
											<h:selectOneMenu value="#{consultaMiscelaneaFiscalBean.criterio.mercado}"
												styleClass="textoControles" converter="mercadoConverter"
												id="selectMercado">
												<f:selectItems
													value="#{consultaMiscelaneaFiscalBean.selectItemsMercado}" />
											</h:selectOneMenu>
										</td>
										<td colspan="2">&#160;</td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </div>
            </h:panelGroup>
            
            <h:panelGroup id="panelResumenCriterios">
            <h:panelGroup rendered="#{consultaMiscelaneaFiscalBean.consultaEjecutada}">
            		<div id="divResumen" style="display: #{consultaMiscelaneaFiscalBean.consultaEjecutada ? 'inline' : 'none'}">
            			<table width="100%" border="0" cellpadding="0px" cellspacing="5px">
            				<tr>
            					<td class="recuadroTabla">
            						<table class="tablaCriterios texto" border="0" style="text-align: center">
            							<tr>
            								<td colspan="2" align="center">
            									<b> <h:outputText styleClass="texto" value="#{etq.participanteMinus}" /> </b>
											</td>											
            							</tr>
            							<tr align="center">
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{etq.participanteMinus}" />
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{etq.cuentaMinus}" />
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{etq.nombreCuenta}" />
	                                        </td>
                                    	</tr>
                                    	<tr align="center">
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.idFolioTraspasante}" rendered="#{!empty consultaMiscelaneaFiscalBean.idFolioTraspasante}"/>
	                                            <h:outputText styleClass="texto" value="TODOS" rendered="#{empty consultaMiscelaneaFiscalBean.idFolioTraspasante}"/>
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.cuenta}" rendered="#{!empty consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.cuenta}"/>
	                                            <h:outputText styleClass="texto" value="TODAS" rendered="#{empty consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.cuenta}"/>
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.nombreCuenta}" rendered="#{!empty consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.nombreCuenta}"/>
	                                            <h:outputText styleClass="texto" value="TODAS" rendered="#{empty consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.nombreCuenta}"/>
	                                        </td>
                                    	</tr>
                                    	<!-- Contraparte -->
                                    	<tr>
            								<td colspan="2" align="center">
            									<b> <h:outputText styleClass="texto" value="#{etq.contraparteMinus}" /> </b>
											</td>											
            							</tr>
            							<tr align="center">
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{etq.contraparteMinus}" />
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{etq.cuentaMinus}" />
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{etq.nombreCuenta}" />
	                                        </td>
                                    	</tr>
                                    	<tr align="center">
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.idFolioContraparte}" rendered="#{!empty consultaMiscelaneaFiscalBean.idFolioContraparte}"/>
	                                            <h:outputText styleClass="texto" value="TODOS" rendered="#{empty consultaMiscelaneaFiscalBean.idFolioContraparte}"/>
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.cuenta}" rendered="#{!empty consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.cuenta}"/>
	                                            <h:outputText styleClass="texto" value="TODAS" rendered="#{empty consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.cuenta}"/>
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.nombreCuenta}" rendered="#{!empty consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.nombreCuenta}"/>
	                                            <h:outputText styleClass="texto" value="TODAS" rendered="#{empty consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.nombreCuenta}"/>
	                                        </td>
                                    	</tr>
									</table>
            					</td>
           						<td class="recuadroTabla">
            						<table class="tablaCriterios texto" border="0" style="text-align: center">
            							<tr>
            								<td colspan="4" align="center">
            									<b> <h:outputText styleClass="texto" value="#{etq.claveValor}" /> </b>
											</td>											
            							</tr>
            							<tr align="center">
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{etq.tv}" />
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{etq.emisoraMinus}" />
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{etq.serieMinus}" />
	                                        </td>
	                                        <td> 
                                    			 <h:outputText styleClass="texto" value="#{etq.bovedaMinus}" />
	                                        </td>
                                    	</tr>
                                    	<tr align="center">
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.criterio.emision.tipoValor.claveTipoValor}" rendered="#{!empty consultaMiscelaneaFiscalBean.criterio.emision.tipoValor.claveTipoValor}"/>
	                                            <h:outputText styleClass="texto" value="TODOS" rendered="#{empty consultaMiscelaneaFiscalBean.criterio.emision.tipoValor.claveTipoValor}"/>
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.criterio.emision.emisora.descripcion}" rendered="#{!empty consultaMiscelaneaFiscalBean.criterio.emision.emisora.descripcion}"/>
	                                            <h:outputText styleClass="texto" value="TODAS" rendered="#{empty consultaMiscelaneaFiscalBean.criterio.emision.emisora.descripcion}"/>
	                                        </td>
	                                        <td>
	                                            <h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.criterio.emision.serie.serie}" rendered="#{!empty consultaMiscelaneaFiscalBean.criterio.emision.serie.serie}"/>
	                                            <h:outputText styleClass="texto" value="TODAS" rendered="#{empty consultaMiscelaneaFiscalBean.criterio.emision.serie.serie}"/>	                                        
	                                        </td>
	                                        <td align="center"> 
                                    			<h:outputText styleClass="texto" value=" #{empty consultaMiscelaneaFiscalBean.criterio.bovedaValores.nombreCorto ? 'TODAS' : consultaMiscelaneaFiscalBean.criterio.bovedaValores.nombreCorto }"/>
                                    		</td>
                                    	</tr>                                     	
									</table>
            					</td>
            					<td class="recuadroTabla">
            						<table class="tablaCriterios texto" border="0" style="text-align: center">
            							<tr>
            								<td colspan="2" align="center">
            									&#160;
											</td>											
											<td colspan="2" align="center">
            									<b> <h:outputText styleClass="texto" value="#{etq.fechaTraspaso}" /> </b>
											</td>
            							</tr>
            							<tr>
            								<td>
            									<h:outputText styleClass="texto" value="#{etq.estatus}" />
            								</td>
            								<td>
            									<h:outputText styleClass="texto" value="#{etq.rol}" />
            								</td>
            								<td align="center">
												<h:outputText styleClass="texto" value="#{etq.inicial}" />
											</td>
											<td align="center">
												<h:outputText styleClass="texto" value="#{etq.final}" />
            								</td>
            							</tr>
            							<tr>
            								<td>
            									<h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.criterio.estadoInstruccion.claveEstadoInstruccion}" rendered="#{!empty consultaMiscelaneaFiscalBean.criterio.estadoInstruccion.claveEstadoInstruccion}"/>
            									<h:outputText styleClass="texto" value="TODOS" rendered="#{empty consultaMiscelaneaFiscalBean.criterio.estadoInstruccion.claveEstadoInstruccion}"/>
            								</td>
            								<td>
            									<h:outputText styleClass="texto" value="#{consultaMiscelaneaFiscalBean.SRol}" rendered="#{!empty consultaMiscelaneaFiscalBean.criterio.rol}"/>
            									<h:outputText styleClass="texto" value="TODOS" rendered="#{empty consultaMiscelaneaFiscalBean.criterio.rol}"/>
            								</td>
            								<td>
												<h:outputText styleClass="texto" id="txtFechaFin1"
															  value="#{consultaMiscelaneaFiscalBean.criterio.fechaInicioPeriodo}">
													<f:converter converterId="formatoFechaCortoConverter" />
            									</h:outputText>
            									
            								</td>
											<td>
												<h:outputText styleClass="texto" id="txtFechaFin2"
															  value="#{consultaMiscelaneaFiscalBean.criterio.fechaFinPeriodo}">
            										<f:converter converterId="formatoFechaCortoConverter" />
            									</h:outputText>
            								</td>
            							</tr>
            							<tr>
	            							<td colspan="2" align="center">
	           									&#160;
											</td>
										</tr>
            							<!-- Se agrega Mercado -->
            							<tr>
            								<td align="center">
												<h:outputText styleClass="texto" value="#{etq.mercadoMinus}" />
											</td>
											<td align="center">
												<h:outputText styleClass="texto" value="#{etq.papelMinus}" />
											</td>
            								<td align="center" colspan="2">
												&#160;
											</td>
            							</tr>
            							<tr>
            								<td align="center">
												<h:outputText
													value="#{consultaMiscelaneaFiscalBean.descripcionPapelMercado}"/>
											</td>
											<td align="center">
												<h:outputText
													value="#{consultaMiscelaneaFiscalBean.descripcionPapelMercado2}"
													title="#{consultaMiscelaneaFiscalBean.descripcionPapelMercadoTitle2}" />
											</td>
											<td align="center" colspan="2">
												&#160;
											</td>
            							</tr>
            						</table>
            					</td>            				
            				</tr>
            			</table>
            		</div>
            	</h:panelGroup>
            	</h:panelGroup>
        </ui:define>
	    
	   
        <ui:define name="seccionContenido">
        	<h:panelGroup id="panelContenido">
        		<h:panelGroup rendered="#{consultaMiscelaneaFiscalBean.consultaEjecutada and not consultaMiscelaneaFiscalBean.existenResultadosConsulta}">
					<table width="100%" border="0" cellpadding="0px" cellspacing="0px">
						<tr>
							<td class="tituloTabla" width="900px">
		                    	<h:outputText value="#{etq.sinResultados}" /> 
							</td>
						</tr>
					</table>
        		</h:panelGroup>
        		<h:panelGroup rendered="#{consultaMiscelaneaFiscalBean.consultaEjecutada and consultaMiscelaneaFiscalBean.existenResultadosConsulta}">
        			<h:panelGroup id="panelPaginacion">
						<table cellpadding="0" cellspacing="0" width="900px" border="0">
	                        <tr>
	                            <td align="left" class="textoEstadoCuenta">
	                                <a4j:commandLink id="control_bitacora_primero"
	                                    action="#{consultaMiscelaneaFiscalBean.irPrimeraPagina}"
	                                    rendered="#{consultaMiscelaneaFiscalBean.estadoPaginacion.irAlPrimero}"
	                                    reRender="panelPaginacion, panelResultados">
	                                    <img src="#{facesContext.externalContext.requestContextPath}/images/control_primero.png" border="0" />
	                                </a4j:commandLink>
	                                <a4j:commandLink id="control_bitacora_atras_fast"
	                                    action="#{consultaMiscelaneaFiscalBean.retrocederPaginasRapido}"
	                                    rendered="#{consultaMiscelaneaFiscalBean.estadoPaginacion.retrocederRapido}"
	                                    reRender="panelPaginacion, panelResultados">
	                                    <img src="#{facesContext.externalContext.requestContextPath}/images/control_atras_fast.png" border="0" />
	                                </a4j:commandLink>
	                                <a4j:commandLink id="control_bitacora_atras"
	                                    action="#{consultaMiscelaneaFiscalBean.retrocederPagina}"
	                                    rendered="#{consultaMiscelaneaFiscalBean.estadoPaginacion.retroceder}"
	                                    reRender="panelPaginacion, panelResultados">
	                                    <img src="#{facesContext.externalContext.requestContextPath}/images/control_atras.png" border="0" />
	                                </a4j:commandLink>
	                                <a4j:commandLink id="control_bitacora_adelante"
	                                    action="#{consultaMiscelaneaFiscalBean.avanzarPagina}"
	                                    rendered="#{consultaMiscelaneaFiscalBean.estadoPaginacion.avanzar}"
	                                    reRender="panelPaginacion, panelResultados">
	                                    <img src="#{facesContext.externalContext.requestContextPath}/images/control_adelante.png" border="0" />
	                                </a4j:commandLink>
	                                <a4j:commandLink id="control_bitacora_adelante_fast"
	                                    action="#{consultaMiscelaneaFiscalBean.avanzarPaginasRapido}"
	                                    rendered="#{consultaMiscelaneaFiscalBean.estadoPaginacion.avanzarRapido}"
	                                    reRender="panelPaginacion, panelResultados">
	                                    <img src="#{facesContext.externalContext.requestContextPath}/images/control_adelante_fast.png" border="0" />
	                                </a4j:commandLink>
	                                <a4j:commandLink id="control_bitacora_ultimo" action="#{consultaMiscelaneaFiscalBean.irUltimaPagina}"
	                                    rendered="#{consultaMiscelaneaFiscalBean.estadoPaginacion.irAlUltimo}"
	                                    reRender="panelPaginacion, panelResultados">
	                                    <img src="#{facesContext.externalContext.requestContextPath}/images/control_ultimo.png" border="0" />
	                                </a4j:commandLink>
	                                <br />
	                                <h:outputText styleClass="textoResumen" value="#{etq.mostrando}" />
	                                <h:outputText styleClass="textoResumen" value="#{consultaMiscelaneaFiscalBean.estadoPaginacion.numeroPagina}" />
	                                <h:outputText styleClass="textoResumen" value="#{etq.de}" />
	                                <h:outputText styleClass="textoResumen" value="#{consultaMiscelaneaFiscalBean.estadoPaginacion.totalPaginas}" />
	                                <h:outputText styleClass="textoResumen" value="#{etq.cierre}" />
	                                &#160;&#160;
	                                <h:outputText styleClass="textoResumen" value="#{consultaMiscelaneaFiscalBean.estadoPaginacion.totalResultados}" />
	                                &#160;
	                                <h:outputText styleClass="textoResumen" value="#{etq.registrosEncontrados}"/>
	                            </td>
	                            <td align="right" class="textoEstadoCuenta">
	                                <h:outputText escape="false" value="#{etq.registrosPorPagina}" styleClass="texto" />
	                                <h:selectOneMenu id="tamanioPagina" styleClass="texto"
	                                    value="#{consultaMiscelaneaFiscalBean.estadoPaginacion.registrosPorPagina}">
	                                    <f:selectItem itemLabel="1" itemValue="1" />
	                                    <f:selectItem itemLabel="2" itemValue="2" />
	                                    <f:selectItem itemLabel="5" itemValue="5" />
	                                    <f:selectItem itemLabel="10" itemValue="10" />
	                                    <f:selectItem itemLabel="20" itemValue="20" />
	                                    <f:selectItem itemLabel="50" itemValue="50" />
	                                    <f:selectItem itemLabel="100" itemValue="100" />
	                                    <a4j:support event="onchange"
	                                        reRender="panelPaginacion, panelResultados"
											action="#{consultaMiscelaneaFiscalBean.buscarMiscelaneaFiscal}" >
											<a4j:actionparam name="navCuentaiDebeBitacorear2"  value="false" 
											assignTo="#{consultaMiscelaneaFiscalBean.guardaBitacoraConsulta}" />
										</a4j:support>
	                                </h:selectOneMenu>
	                            </td>
	                        </tr>
	                    </table>
        			</h:panelGroup>
	        		<h:panelGroup id="panelResultados">
	        			<table border="0" class="tablaResultadosMiscelaneas" width="900px" cellspacing="0px">
								<tr>
									<th class="tituloTabla" width="8%" >
										<h:outputText value="#{etq.fechaTraspaso}" />
									</th>
									<th class="tituloTabla" width="8%" >
										<h:outputText value="#{etq.folioControl}" />
									</th>
									<th class="tituloTabla"  width="5%" >
										<h:outputText value="#{etq.tv}" />
									</th>
									<th class="tituloTabla" width="8%" >
										<h:outputText value="#{etq.emisora}" />
									</th>
									<th class="tituloTabla" width="9%" >
										<h:outputText value="#{etq.serie}" />
									</th>
									<th class="tituloTabla" width="9%" >
										<h:outputText value="#{etq.cupon}" />
									</th>
									<th class="tituloTabla"  >
										<h:outputText value="#{etq.isin}" />
									</th>
									<th class="tituloTabla" >
										<h:outputText value="#{etq.bovedaMinus}" />
									</th>
									<th class="tituloTabla" width="5%">
										<h:outputText value="#{etq.estatus}" />
									</th>
									<th class="tituloTabla" width="8%">
										<h:outputText value="#{etq.cantidadOperada}" />
									</th>
									<th class="tituloTabla" width="14%">
										<h:outputText value="#{etq.precioAdquisicionMinus}" />
									</th>
									<th class="tituloTabla" width="8%">
										<h:outputText value="#{etq.fechaAdquisicionMinus}" />
									</th>
								</tr>
								<tr>
									<th colspan="3" class="tituloTabla">
										<h:outputText value="#{etq.clienteMinus}"/>
									</th>
									<th class="tituloTabla">
										<h:outputText value="#{etq.mercadoMinus}"/>
									</th>
									<th class="tituloTabla">
										<h:outputText value="#{etq.rfcCurp}"/>
									</th>
									<th colspan="2" class="tituloTabla">
										<h:outputText value="#{etq.instTraspasante}"/>
									</th>
									<th class="tituloTabla">
										<h:outputText value="#{etq.cuentaTraspasante}"/>
									</th>
									<th colspan="2" class="tituloTabla">
										<h:outputText value="#{etq.instReceptor}"/>
									</th>
									<th class="tituloTabla">
										<h:outputText value="#{etq.cuentaReceptor}"/>
									</th>
									<th class="tituloTabla" width="14%">
										<h:outputText value="#{etq.costoPromedio}"/>
									</th>
								</tr>
								<t:dataList value="#{consultaMiscelaneaFiscalBean.listaMiscelaneaFiscal}" var="lmf" rowIndexVar="indice">
									<tr>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.fechaConcertacion}" converter="formatoFechaLargoConverter" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.folioControl}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.emision.tipoValor.claveTipoValor}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.emision.emisora.descripcion}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.emision.serie.serie}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.cupon.claveCupon}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.emision.isin}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.boveda}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.estadoInstruccionEnvio.claveEstadoInstruccion}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'}" align="right">
											<h:outputText value="#{lmf.cantidadTitulos}">
												<f:convertNumber pattern="###,###,###,###,##0"/>
											</h:outputText>
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'}" align="right">
											<h:outputText value="#{lmf.miscelaneaFiscal.precioAdquisicion}">
												<f:convertNumber pattern="$ ###,###,###,###,###.00000000"/>
											</h:outputText>
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.fechaAdquisicion}" converter="formatoFechaCortoConverter"/>
											&#160;
										</td>
									</tr>
									<tr>
										<td colspan="3" class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.miscelaneaFiscal.cliente}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.emision.tipoValor.mercado.descripcion}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.miscelaneaFiscal.curpRfc}" />
											&#160;
										</td>
										<td colspan="2" class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.institucionTraspasante.claveTipoInstitucion}#{lmf.institucionTraspasante.folioInstitucion} - #{lmf.institucionTraspasante.nombreCorto}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.cuentaNombradaTraspasante.cuenta}" />
											&#160;
										</td>
										<td colspan="2" class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.institucionReceptora.claveTipoInstitucion}#{lmf.institucionReceptora.folioInstitucion} - #{lmf.institucionReceptora.nombreCorto}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'} centrado">
											<h:outputText value="#{lmf.cuentaNombradaReceptora.cuenta}" />
											&#160;
										</td>
										<td class="#{indice%2 == 0 ?'renglonTablaUno':'renglonTablaDos'}" align="right">
											<h:outputText value="#{lmf.miscelaneaFiscal.costoPromedio}">
												<f:convertNumber pattern="$ ###,###,###,###,###.00000000"/>
											</h:outputText>
											&#160;
										</td>
									</tr>
								</t:dataList>
							</table>
							<br/>
							<table cellpadding="0" cellspacing="0" border="0" align="center" width="900">
				                <tr align="right">
				                    <td align="right">
										<h:commandButton 
			                            	id="generarPdf"
			                               	action="consultaMiscelaneaFiscalPdf"
			                               	actionListener="#{consultaMiscelaneaFiscalBean.generarReportes}"
			                               	image="/images/pdf.gif"
			                               	title="Exportar a PDF todos los resultados de la consulta"
			                               	onclick="bloquearBotonesReportes(['generarExcel', 'generarPdf']);" />                                    
			                           	&#160;&#160;
			                           	<h:commandButton 
			                           		id="generarExcel"
			                           		action="consultaMiscelaneaFiscalXls"
			                           		actionListener="#{consultaMiscelaneaFiscalBean.generarReportes}"
											image="/images/excel-file.gif"
			                           		title="Exportar a Excel todos los resultados de la consulta"
			                           		onclick="bloquearBotonesReportes(['generarExcel', 'generarPdf']);" />

										<div id="monitorPeticionReporte" style="display: none;">
											<h:panelGroup id="panelMonitorPeticionReporte">
												<h:graphicImage value="/images/ajax-loader.gif" />
												&#160;&#160;
												<h:outputText value="#{etq.reporteEnProceso}" />
												<a4j:commandButton id="btnActualizarEstadoPeticion"
													image="/images/transparent.gif"
													styleClass="submit"
													actionListener="#{consultaMiscelaneaFiscalBean.actualizarEstadoPeticion}"
													reRender="panelMonitorPeticionReporte"
													oncomplete="desbloquearBotonesReportes(#{consultaMiscelaneaFiscalBean.peticionReporteCompleta}, ['generarExcel', 'generarPdf']);"/>
											</h:panelGroup>
										</div>

				                    </td>
				                </tr>
				            </table>
	        		</h:panelGroup>
        		</h:panelGroup>
        	</h:panelGroup>

        </ui:define>
        
        <ui:define name="botones">  
        	<h:panelGroup id="panelBotones">
	        	<div class="refrescar" style="float: left;">
					<a4j:status id="commonStatus">
						<f:facet name="start">
							<h:panelGroup>
								<h:graphicImage value="/images/ajax-loader.gif" />
								<h:outputText value="#{etq.buscando}"></h:outputText>
							</h:panelGroup>
						</f:facet>
					</a4j:status>
				</div>	        
		         	
			            <div class="limpiar" style="float: center">
			                <h:commandButton id="botonLimpiar" image="/images/transparent.gif" styleClass="submit" tabindex="140"
			                    actionListener="#{consultaMiscelaneaFiscalBean.limpiar}">
			                </h:commandButton>
			            </div>
		            
		            
			            <div class="buscar" style="float: center">
			                <a4j:commandButton id="botonBuscar" image="/images/transparent.gif" styleClass="submit" tabindex="130"
			                	onclick="javascript:presentarResumen();"
			                    action="#{consultaMiscelaneaFiscalBean.buscarMiscelaneaFiscal}"
								reRender="panelContenido, panelBotones, panelResumenCriterios">
								
								<a4j:actionparam name="navCuentaiDebeBitacorear"  value="true" 
											assignTo="#{consultaMiscelaneaFiscalBean.guardaBitacoraConsulta}" />
							</a4j:commandButton>
			            </div>
		            
			            <div class="editar" style="display:#{consultaMiscelaneaFiscalBean.consultaEjecutada?'inline':'none'};float:right;" id="botonEditarCriterios">            
			            	<input type="image" class="submit"
								src="#{facesContext.externalContext.requestContextPath}/images/transparent.gif"
								alt="Editar Criterios" title="Editar Criterios"
								onclick='javascript:presentarCriterios();return false;' />                      	
		            	</div>
	            	
			</h:panelGroup>
       	</ui:define> <!-- ui:define:: botones -->
    </ui:composition>


    <!-- FIN DEL DECORATE -->
</html>