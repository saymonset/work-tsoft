<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xls="http://indeval.com/jsf/xls" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:cvt="http://indeval.com/jsf/converters">

    <xls:document documentName="consultaMiscelaneaFiscal" documentTitle="Consulta MiscelÃ¡nea Fiscal"
        institucion="#{elegirInstitucionBean.descripcionInstitucion}" fecha="#{elegirInstitucionBean.fechaActual}">

        <xls:table value="#{consultaMiscelaneaFiscalBean}" var="dummy">
            <xls:row>
                <xls:col header="#{etq.participanteMinus}" value="#{!empty consultaMiscelaneaFiscalBean.idFolioTraspasante ? consultaMiscelaneaFiscalBean.idFolioTraspasante : 'TODOS'}" align="center" />
                <xls:col header="#{etq.cuentaParticipante}" value="#{!empty consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.cuenta ? consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.cuenta : 'TODAS'}" align="center" />
                <xls:col header="#{etq.nombreCuenta}" value="#{!empty consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.nombreCuenta ? consultaMiscelaneaFiscalBean.criterio.cuentaParticipante.nombreCuenta : 'TODAS'}" align="center" />
                
                <xls:col header="#{etq.contraparteMinus}" value="#{!empty consultaMiscelaneaFiscalBean.idFolioContraparte ? consultaMiscelaneaFiscalBean.idFolioContraparte : 'TODOS'}" align="center" />
                <xls:col header="#{etq.cuentaContraparte}" value="#{!empty consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.cuenta ? consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.cuenta : 'TODAS'}" align="center" />
                <xls:col header="#{etq.nombreCuenta}" value="#{!empty consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.nombreCuenta ? consultaMiscelaneaFiscalBean.criterio.cuentaContraparte.nombreCuenta : 'TODAS'}" align="center" />
                
                <xls:col header="#{etq.tv}" value="#{!empty consultaMiscelaneaFiscalBean.criterio.emision.tipoValor.claveTipoValor ? consultaMiscelaneaFiscalBean.criterio.emision.tipoValor.claveTipoValor : 'TODOS'}" align="center" />
                <xls:col header="#{etq.emisoraMinus}" value="#{!empty consultaMiscelaneaFiscalBean.criterio.emision.emisora.descripcion ? consultaMiscelaneaFiscalBean.criterio.emision.emisora.descripcion : 'TODAS'}" align="center" />
                <xls:col header="#{etq.serieMinus}" value="#{!empty consultaMiscelaneaFiscalBean.criterio.emision.serie.serie ? consultaMiscelaneaFiscalBean.criterio.emision.serie.serie : 'TODAS'}" align="center" />
                <xls:col header="#{etq.bovedaMinus}" value="#{!empty consultaMiscelaneaFiscalBean.criterio.bovedaValores.nombreCorto ? consultaMiscelaneaFiscalBean.criterio.bovedaValores.nombreCorto : 'TODAS'}" align="center" />
                <xls:col header="#{etq.mercadoMinus}" value="#{consultaMiscelaneaFiscalBean.descripcionPapelMercado}" align="center" />
                <xls:col header="#{etq.estatus}" value="#{!empty consultaMiscelaneaFiscalBean.criterio.estadoInstruccion.claveEstadoInstruccion ? consultaMiscelaneaFiscalBean.criterio.estadoInstruccion.claveEstadoInstruccion : 'TODOS'}" align="center" />
                <xls:col header="#{etq.rol}" value="#{!empty consultaMiscelaneaFiscalBean.SRol ? consultaMiscelaneaFiscalBean.SRol : 'TODOS'}" align="center" />
                <xls:col header="#{etq.fechaTraspaso} #{etq.inicial}" value="#{consultaMiscelaneaFiscalBean.criterio.fechaInicioPeriodo}"
						 align="center" pattern="dd/MM/yyyy" />
				<xls:col header="#{etq.fechaTraspaso} #{etq.final}" value="#{consultaMiscelaneaFiscalBean.criterio.fechaFinPeriodo}"
						 align="center" pattern="dd/MM/yyyy" />
            </xls:row>
        </xls:table>

        <xls:table value="#{consultaMiscelaneaFiscalBean}" var="totales">
        	<xls:row>
        		<xls:col header="#{etq.registrosEncontrados}" value="#{consultaMiscelaneaFiscalBean.totalRegistros}"/>
        	</xls:row>
        </xls:table>

        <xls:table value="#{consultaMiscelaneaFiscalBean.listaMiscelaneaFiscalReportes}" var="lmf">
            <xls:row>
                <xls:col header="#{etq.fechaTraspaso}" value="#{lmf.fechaConcertacion}" align="center" pattern="dd/MM/yyyy HH:mm:ss"/>
                <xls:col header="#{etq.folioControl}" value="#{lmf.folioControl}" align="center" />
                <xls:col header="#{etq.tv}" value="#{lmf.emision.tipoValor.claveTipoValor}" align="center" />
                <xls:col header="#{etq.emisora}" value="#{lmf.emision.emisora.descripcion}" align="center" />
                <xls:col header="#{etq.serie}" value="#{lmf.emision.serie.serie}" align="center" />
                <xls:col header="#{etq.cupon}" value="#{lmf.cupon.claveCupon}" align="center" />
                <xls:col header="#{etq.isin}" value="#{lmf.emision.isin}" align="center" />
                <xls:col header="#{etq.bovedaMinus}" value="#{lmf.boveda}" align="center" />
                <xls:col header="#{etq.estatus}" value="#{lmf.estadoInstruccionEnvio.claveEstadoInstruccion}" align="center" />
                <xls:col header="#{etq.cantidadOperada}" value="#{lmf.cantidadTitulos}" align="center" pattern="###,###,###,###,###,##0"/>
                <xls:col header="#{etq.precioAdquisicionMinus}" value="#{lmf.miscelaneaFiscal.precioAdquisicion}" align="center" pattern="$###,###,###,###,###,###.00000000"/>
                <xls:col header="#{etq.fechaAdquisicionMinus}" value="#{lmf.fechaAdquisicion}" align="center" pattern="dd/MM/yyyy"/>
                <xls:col header="#{etq.costoPromedio}" value="#{lmf.miscelaneaFiscal.costoPromedio}" align="center" pattern="$###,###,###,###,###,###.00000000"/>
                <xls:col header="#{etq.clienteMinus}" value="#{lmf.miscelaneaFiscal.cliente}" align="center" />
                <xls:col header="#{etq.mercadoMinus}" value="#{lmf.emision.tipoValor.mercado.descripcion}" align="center" />
                <xls:col header="#{etq.rfcCurp}" value="#{lmf.miscelaneaFiscal.curpRfc}" align="center"/>
                <xls:col header="#{etq.instTraspasante}" value="#{lmf.institucionTraspasante.claveTipoInstitucion}#{lmf.institucionTraspasante.folioInstitucion} - #{lmf.institucionTraspasante.nombreCorto}" align="center"/>
                <xls:col header="#{etq.cuentaTraspasante}" value="#{lmf.cuentaNombradaTraspasante.cuenta}" align="center"/>
                <xls:col header="#{etq.instReceptor}" value="#{lmf.institucionReceptora.claveTipoInstitucion}#{lmf.institucionReceptora.folioInstitucion} - #{lmf.institucionReceptora.nombreCorto}" align="center" />
                <xls:col header="#{etq.cuentaReceptor}" value="#{lmf.cuentaNombradaReceptora.cuenta}" align="center" />
            </xls:row>
        </xls:table>

    </xls:document>
</html>