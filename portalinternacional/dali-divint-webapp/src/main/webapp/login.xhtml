<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core" xml:lang="en" lang="en"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:indeval="http://indeval.com/indeval">



		<ui:composition template="/layoutLogin.xhtml">
			
			
			<ui:define name="body">
			
			<h:form id="loginForm">
				
			     
			     <table width="761" align="center" cellpadding="0" cellspacing="0" class="tabla_login" border="0">
						        <tr>
						          <td width="495" valign="top"  class="tabla_login_izq" height="350" >
								          <table width="786" border="0" cellpadding="2" cellspacing="0" class="tabla_campos" >
								          		<tr>
								          			<td>&#160;</td>
								          							          			
								          		</tr>
								          		<tr >
								          			
								          			<td height="25">&#160;</td>
								          			<td colspan="1" height="50" valign="top" rowspan="2">
								          			
								          			<div id="mensajes" style="display: #{( not empty inicioSesionBean.mensajeError or inicioSesionBean.mensajesCaptcha) ? 'inline' : 'none'}" >
															<table width="92%" border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td class="tituloMensaje">
																		&#160;
																	</td>
																</tr>
																<tr>
																	
																	<td align="center">
																			<div class="warning">
																					<h:outputText value="#{inicioSesionBean.mensajeError}" />
																					<h:message for="inputCaptcha"></h:message>
																			</div>
																	</td>
																</tr>
															</table>
															
														</div>
								          				
								          			</td>
								          		</tr>
								          		<tr>
								          			<td>&#160;</td>
								          							          			
								          		</tr>
								              <tr>
								                <td width="207" ><div align="right"><h:outputText value="#{etq.usuarioMinus}"/>:</div></td>
								                
								                <td width="284"><h:inputText autocomplete="off" value="#{inicioSesionBean.usuario}"	id="usuario" />
								                				<input type="text" style="display:none" />
								                </td>
								              </tr>
								              <tr> 
								                <td><div align="right"><h:outputText value="#{etq.contrasenaMinus}"/>:</div></td>
								            
								                <td><h:inputSecret value="#{inicioSesionBean.password}" id="password"  redisplay="true" />
								                	<input type="text" style="display:none" />
								                </td>
								              </tr>
								              
								              <tr>
								                <td>
										            <a4j:outputPanel id="panelFirma">
														<h:panelGroup rendered="#{inicioSesionBean.tipoAutenticacion eq 4}">
															<table align="center" border="0" cellpadding="0" cellspacing="0">
																<!-- Firmar del Applet -->
																<tr>
																	<td>
																		<div style="display: none">
																			<textarea id="ticketSinFirmar" name="ticketSinFirmar">#{inicioSesionBean.ticketSinFirmar}</textarea>
																			<textarea id="ticketFirmado" name="ticketFirmado">#{inicioSesionBean.ticketFirmado}</textarea>
																		</div>
																		<script>
													               			function firmarOperacion(){
													             		    	$j("input[id$='btnIniciaSesion']").click();
													               			}
													               		</script>
																		<div id="divAppletLogin">
																			<ui:decorate template="/firmaDigitalLogin.xhtml" />
																		</div>
																	</td>
																</tr>
															</table>
														</h:panelGroup>
													</a4j:outputPanel>
											</td>
								                
								                <td>&#160;</td>
								              </tr>
								              <tr>
								                <td>&#160;</td>
								                
								                <td>
								                <a4j:outputPanel id="panelCaptcha">
																<h:panelGroup rendered="#{inicioSesionBean.mostrarCaptcha}">
																				<indeval:captcha align="center"  
																						value="#{inicioSesionBean.textoCaptcha}"
																						id="inputCaptcha">
		
																						<rich:paint2D id="captcha3" width="200" height="70"
																							format="jpeg" paint="#{inicioSesionBean.paint}"
																							data="#{inicioSesionBean.captchaId}" border="2"/>
																						<br />
																						<h:outputText styleClass="texto" value="#{etq.textoImagen}" />
																						<br />
																						<indeval:captchaValidator />&#160;
																					</indeval:captcha>
																</h:panelGroup>
													</a4j:outputPanel>
												
												
												</td>
								              </tr>
								             
								              
								               <tr>
								                <td>&#160;</td>
								                
								                <td>&#160;</td>
								              </tr>
								              <tr>
								                <td>&#160;</td>
								              
								                <td>        	
								                						                
								                		
																	
																	
														<h:panelGroup id="panelBotonLogin">
					                					
									                		<h:commandButton
									                			id="btnDeterminaLogin"
																action="#{inicioSesionBean.determinaLogin}"
																rendered="#{inicioSesionBean.tipoAutenticacion eq '-1'}"
																value="INICIAR SESI&#211;N"
																image="/images/transparent.gif"
																styleClass="btn_login" />
															<h:commandButton
																id="btnLogin"
																action="#{inicioSesionBean.iniciarSesion}"
																rendered="#{inicioSesionBean.tipoAutenticacion ne '-1'}"
																value="INICIAR SESI&#211;N"
																image="/images/transparent.gif"
																styleClass="btn_login" />
																
															<div id="divBotonInicioSesion" style="display: none;">													
																<h:commandButton id="btnIniciaSesion" action="#{inicioSesionBean.iniciarSesion}" />
															</div>
															
									                	</h:panelGroup>
						                	 
								                </td>
								              </tr>
								              <tr>
								              		<td colspan="2" align="right" valign="bottom" height="13">
								              				
											   				<h:graphicImage value="/imgs_login/1px_linea_blanca.gif"  width="350" height="1"></h:graphicImage>
											   		</td>
											   </tr>
								          </table>
						       </td>
						       <td width="254" valign="top" class="tabla_login_der">&#160;</td>
						   </tr>
						   
					</table>
						      
						 
									     
			     <iframe class="divModal"  id="firmaDigitalLogin"  frameborder="0"  scrolling="no" align="top"></iframe>
			     <a4j:poll id="pollping" interval="30000" reRender="panelCaptcha" ajaxSingle="true" />
			</h:form>
			
			
			
			
				
			
			</ui:define>

		</ui:composition>



</html>
