<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:xls="http://indeval.com/jsf/xls"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:cvt="http://indeval.com/jsf/converters">


    <xls:document documentName="consultaDerechos" documentTitle="Consulta de Derechos"
                  institucion="#{consultaDerechosExportacionBean.agenteFirmado.id} #{consultaDerechosExportacionBean.agenteFirmado.folio} #{consultaDerechosExportacionBean.agenteFirmado.razon}"
                  fecha="#{consultaDerechosExportacionBean.fechaActual}">
        <xls:table value="consultaDerechosExportacionBean" var="dummy">
            <xls:row>
                <xls:col header="CRITERIOS DE CONSULTA" value="" align="center" />
            </xls:row>
        </xls:table>
        <xls:table value="#{consultaDerechosExportacionBean}" var="resultado">
            <xls:row>
                <xls:col header="#{etq.institucionMinus}" value="#{(empty sessionScope.roles['INT_BEN_INDEVAL'] and empty sessionScope.roles['INT_BEN_INDEVAL_ADMIN']) ? consultaDerechosExportacionBean.claveFolio : consultaDerechosExportacionBean.param.claveInstitucion}" align="center" />
                <xls:col header="#{etq.tv}" value="#{consultaDerechosExportacionBean.param.emision.tv}" align="center" />
                <xls:col header="#{etq.emisoraMinus}" value="#{consultaDerechosExportacionBean.param.emision.emisora}" align="center" />
                <xls:col header="#{etq.serieMinus}" value="#{consultaDerechosExportacionBean.param.emision.serie}" align="center" />
                <xls:col header="#{etq.cuponMinus}" value="#{consultaDerechosExportacionBean.param.emision.cupon}" align="center"/>
                <xls:col header="#{etq.isin}" value="#{consultaDerechosExportacionBean.param.emision.isin}" align="center"/>                                                                                
                <xls:col header="#{etq.divisaMinus}" value="#{consultaDerechosExportacionBean.param.divisa}" align="center" />
                <xls:col header="#{etq.bovedaMinus}" value="#{consultaDerechosExportacionBean.param.bovedaCustodio}" align="center" />
                <xls:col header="#{etq.estado}" value="#{consultaDerechosExportacionBean.param.descEstatusDerecho}" align="center"/>
                <xls:col header="#{etq.fechaCorteMinus} Inicio" value="#{consultaDerechosExportacionBean.param.fechaCorte}" align="center" pattern="dd-MM-yyyy" />
                <xls:col header="#{etq.fechaPago}" value="#{consultaDerechosExportacionBean.param.fechaPago}" align="center" pattern="dd-MM-yyyy" />                
            </xls:row>
        </xls:table>
        <xls:br />
        <xls:subtitle value="#{etq.registrosEncontrados}: #{consultaDerechosExportacionBean.paginaReportes.totalRegistros}" />
        <xls:br />      
        <xls:subtitle value="Datos"/>
        <xls:table value="#{consultaDerechosExportacionBean.paginaReportes.registros}" var="detalle">
            <xls:row>
                <xls:col header="#{etq.idTipoDerecho}" value="#{detalle.idTipoDerecho}"
                         align="CENTER" oddColorDark="true" />            
                <xls:col header="#{etq.tipoDerecho}" value="#{detalle.descTipoDerecho}"
                         align="CENTER" oddColorDark="true" />
                <xls:col header="#{etq.idSubTipoDerecho}" value="#{detalle.idSubtipoDerecho}"
                         align="CENTER" oddColorDark="true" />                           
                <xls:col header="#{etq.subtipoDerecho}" value="#{detalle.descSubtipoDerecho}" 
                         align="CENTER" oddColorDark="true" />
                <xls:col header="#{etq.tv}" value="#{detalle.emision.tv}"
                         align="CENTER" oddColorDark="true" />
                <xls:col header="#{etq.emisoraMinus}" value="#{detalle.emision.emisora}" 
                		 align="CENTER" oddColorDark="true" />
                <xls:col header="#{etq.serieMinus}" value="#{detalle.emision.serie}" 
                		 align="CENTER" oddColorDark="true"/>                		
                <xls:col header="#{etq.cuponMinus}" value="#{detalle.emision.cupon}"
                         align="CENTER" oddColorDark="true"/>
                <xls:col header="#{etq.isin}" value="#{detalle.emision.isin}" 
                		 align="CENTER" oddColorDark="true"/>                    
                <xls:col header="#{etq.fechaCorteMinus}" value="#{detalle.fechaCorte}" 
                		 align="CENTER" oddColorDark="true"  pattern="dd/MM/yyyy"/>
                <xls:col header="#{etq.fechaPago}" value="#{detalle.fechaPago}" 
                		 align="CENTER" oddColorDark="true"  pattern="dd/MM/yyyy"/>
                <xls:col header="#{etq.proporcionMinus}" value="#{detalle.proporcion}" 
                		 align="CENTER" oddColorDark="true" pattern="#0.00##"/>                		 
                <xls:col header="#{etq.divisaMinus}" value="#{detalle.divisa}" 
                		 align="CENTER" oddColorDark="true"/>                		 
                <xls:col header="#{etq.bovedaMinus}" value="#{detalle.bovedaCustodio}" 
                		 align="CENTER" oddColorDark="true"/>
                <xls:col header="#{etq.estado}" value="#{detalle.descEstatusDerecho}" 
                		 align="CENTER" oddColorDark="true"/>                		                 		                 		                 		                 		                 		                 		                 		                 		                 		                 		                 		 
            </xls:row>
        </xls:table>
    </xls:document>
</html>