<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xls="http://indeval.com/jsf/xls" xmlns:cvt="http://indeval.com/jsf/converters">

    <xls:document documentName="calendarioCapitales" documentTitle="Envió Capitales Distribución"
        institucion="#{consultaBitacoraEnvOpBean.agenteFirmado.id} #{consultaBitacoraEnvOpBean.agenteFirmado.folio} #{consultaBitacoraEnvOpBean.agenteFirmado.razon}" 
        landscape="true" fecha="#{envioMensajesCapitalesBean.fechaActual}"
        imageResource="/images/indeval.jpg">
        <xls:table value="#{envioMensajesCapitalesBean}" var="calendarioEnvio">
            <xls:row>
                <xls:col header="#{etq.folioIndeval}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.folioIndeval ? envioMensajesCapitalesBean.calendarioEnvio.folioIndeval : 'TODOS'}" />
                <xls:col header="#{etq.calFolioMensajeIndeval}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.folioMensajeIndeval ? envioMensajesCapitalesBean.calendarioEnvio.folioMensajeIndeval : 'TODAS'}" />
                <xls:col header="#{etq.numeroEnvio}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.idEnvios ? envioMensajesCapitalesBean.calendarioEnvio.idEnvios : 'TODAS'}"  />
			    <xls:col header="#{etq.calFechaEnvioInicio}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.fechaEnvioInicio ? envioMensajesCapitalesBean.calendarioEnvio.fechaEnvioInicio : 'TODAS'}"
				pattern="dd/MM/yyyy" />
			   <xls:col header="#{etq.calFechaEnvioFin}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.fechaEnvioFin ? envioMensajesCapitalesBean.calendarioEnvio.fechaEnvioFin : 'TODAS'}"
				 pattern="dd/MM/yyyy" />
			    <xls:col header="#{etq.fechaModificacionInicio}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.fechaModificacionInicio ? envioMensajesCapitalesBean.calendarioEnvio.fechaModificacionInicio : 'TODAS'}"
				pattern="dd/MM/yyyy" />
			    <xls:col header="#{etq.fechaModificacionFin}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.fechaModificacionFin ? envioMensajesCapitalesBean.calendarioEnvio.fechaModificacionFin : 'TODAS'}"
				pattern="dd/MM/yyyy" />
			    <xls:col header="#{etq.destinatario}" value="#{!empty envioMensajesCapitalesBean.selectedDestinatario ? envioMensajesCapitalesBean.selectedDestinatario : 'TODOS'}" />                
                <xls:col header="#{etq.usuarioMinus}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.usuario ? envioMensajesCapitalesBean.calendarioEnvio.usuario : 'TODOS'}"  />
                <xls:col header="#{etq.consecutivo}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.consecutivo ? envioMensajesCapitalesBean.calendarioEnvio.consecutivo : 'TODOS'}"  />
                <xls:col header="#{etq.tv}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.tipoValor ? envioMensajesCapitalesBean.calendarioEnvio.tipoValor : 'TODOS'}"  />			
				<xls:col header="#{etq.emisoraMinus}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.emisora ? envioMensajesCapitalesBean.calendarioEnvio.emisora :  'TODOS'}"  />
				<xls:col header="#{etq.serieMinus}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.serie ? envioMensajesCapitalesBean.calendarioEnvio.serie : 'TODOS'}"   />
				<xls:col header="#{etq.isin}" value="#{!empty envioMensajesCapitalesBean.calendarioEnvio.isin ? envioMensajesCapitalesBean.calendarioEnvio.isin : 'TODOS'}"   />	
				<xls:col header="#{etq.ACKAMH}" value="#{!empty envioMensajesCapitalesBean.selectedACKAMH ? envioMensajesCapitalesBean.selectedACKAMH : 'TODOS'}" />
                <xls:col header="#{etq.ACKBolsas}" value="#{!empty envioMensajesCapitalesBean.selectedACKBolsas ? envioMensajesCapitalesBean.selectedACKBolsas : 'TODOS' }" />
            </xls:row>
        </xls:table>
        
        <xls:br/>
        <xls:subtitle  value="#{etq.registrosEncontrados}: #{envioMensajesCapitalesBean.totalRegistrosReportes}"/>
        <xls:br/>

        <xls:table value="#{envioMensajesCapitalesBean.paginaReportes.registros}" var="envioIntSic">
            <xls:row>
				<xls:col header="#{etq.idBitacora}" value="#{envioIntSic.idEnvioIntSic}"  />
				<xls:col header="#{etq.calFolioMensajeIndeval}" value="#{envioIntSic.idHistorico}"  />
				<xls:col header="#{etq.folioIndeval}" value="#{envioIntSic.idCalendario}"  />
				<xls:col header="#{etq.tv}" value="#{envioIntSic.tipoValor}"  />
				<xls:col header="#{etq.emisoraMinus}" value="#{envioIntSic.emisora}" />
				<xls:col header="#{etq.serieMinus}" value="#{envioIntSic.serie}" />
				<xls:col header="#{etq.isin}" value="#{envioIntSic.isin}" />
				<xls:col header="#{etq.estado}" value="#{envioIntSic.nombreEstado} "  />
				<xls:col header="#{etq.destinatario}" value="#{envioIntSic.nombreDestinatario} "  />
				<xls:col header="#{etq.ACKAMHEnviado}" value="#{envioIntSic.ackAmh == 0 ? 'Enviado' : envioIntSic.ackAmh == 1 ? 'Confirmado' : envioIntSic.ackAmh == 2 ? 'Error NACK' : ''}"  />
				<xls:col header="#{etq.ACKBolsasEnviado}" value="#{envioIntSic.ackSwift == 0 ? 'Enviado' : envioIntSic.ackSwift == 1 ? 'Confirmado' : envioIntSic.ackSwift == 2 ? 'Error NACK' : ''}"  />
				<xls:col header="#{etq.numeroEnvio}" value="#{envioIntSic.numeroEnvio}"  />
				<xls:col header="#{etq.fechaEnvio}" value="#{envioIntSic.fechaEnvio}"  pattern="dd/MM/yyyy HH:mm:ss" />
				<xls:col header="#{etq.fechaModificacion}" value="#{envioIntSic.fechaActualizacion}"  pattern="dd/MM/yyyy HH:mm:ss" />
				<xls:col header="#{etq.usuarioMinus}" value="#{envioIntSic.usuario}"  />
				<xls:col header="#{etq.consecutivo}" value="#{envioIntSic.consecutivo}"  />
			</xls:row>
        </xls:table>
    </xls:document>
</html>